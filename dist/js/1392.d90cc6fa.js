"use strict";(self["webpackChunk_4010_assetweb"]=self["webpackChunk_4010_assetweb"]||[]).push([[1392],{78067:function(e,t,i){i.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{top:"0","custom-class":"dialog","show-close":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.dialogVisibleOpened,close:e.dialogVisibleClose,closed:e.dialogVisibleClosed}},[t("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"left"},[t("span",[e._v(e._s(e.$t("h.title15")))])]),t("div",{staticClass:"right"},[t("i",{staticClass:"el-icon-close",on:{click:function(t){e.dialogVisible=!1}}})])]),t("div",{staticClass:"dialog-body"},[t("el-tabs",{staticStyle:{height:"100%"},attrs:{"tab-position":"left"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("h.basicInformation"),name:"base"}},[t("div",{staticClass:"tab-pane-titel"},[t("span",[e._v(e._s(e.$t("h.basicInformation")))])]),t("div",{staticClass:"tab-pane-content"},[t("el-row",{attrs:{gutter:20}},e._l(e.billFormDetail,(function(i,a){return t("el-col",{key:a,class:i.class,attrs:{span:i.span}},[e._v(" "+e._s(i.val)+" ")])})),1)],1),t("div",{staticClass:"tab-pane-titel"},[t("span",[e._v(e._s(e.$t("h.List")))]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.print,expression:"print"}],staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:e.printAssetCard}},[e._v(e._s(e.$t("h.printLabelBtn")))])],1),t("div",{staticClass:"tab-pane-table"},[e._t("table")],2),t("div",{staticClass:"tab-pane-pagination"},[e._t("pagination")],2)]),e.audit?t("el-tab-pane",{attrs:{label:e.$t("h.auditInformation"),name:"audit"}},[t("el-timeline",e._l(e.auditStep,(function(a,l){return t("el-timeline-item",{key:l},["pedding"==a.state?t("div",{staticClass:"audit-info"},[t("div",{staticClass:"audit-staff"},[t("img",{attrs:{src:i(36108),alt:""}}),t("span",[e._v(e._s(a.auditStaffName))]),t("i",{class:"icon el-icon-"+a.auditState})]),t("div",{staticClass:"popconfirm"},["success"==a.auditState?t("h5",[e._v(" "+e._s(e.$t("h.agree"))+" ")]):e._e(),"error"==a.auditState?t("h5",[e._v(" "+e._s(e.$t("h.reject"))+" ")]):e._e(),"more"==a.auditState?t("h5",[e._v(" "+e._s(e.$t("h.PendingApproval"))+" ")]):e._e(),t("span",[e._v(e._s(a.message))])])]):t("span",[e._v(e._s(e.$t("h.end")))])])})),1)],1):e._e()],1)],1)])},l=[],s={components:{},data(){return{activeName:"base"}},props:{billDetailDialogVisible:{type:Boolean,default:!1},billFormDetail:{type:Array,default:()=>[]},audit:{type:Boolean,default:!0},auditStep:{type:Array,default:()=>[]},print:{type:Boolean,default:!1}},computed:{dialogVisible:{get(){return this.billDetailDialogVisible},set(e){this.$emit("update:billDetailDialogVisible",e)}}},methods:{dialogVisibleOpened(){this.$emit("opened")},dialogVisibleClose(){document.querySelector(".el-tabs__content").scrollTop=0},dialogVisibleClosed(){this.activeName="base",this.$emit("closed")},printAssetCard(){console.log(this.billFormDetail),this.$emit("print")}}},n=s,r=i(1001),o=(0,r.Z)(n,a,l,!1,null,"7bd948f5",null),d=o.exports},42041:function(e,t,i){i.d(t,{Z:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{top:"0","custom-class":"dialog",fullscreen:"",visible:e.dialogVisible,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.dialogVisibleOpened,close:e.dialogVisibleClose,closed:e.dialogVisibleClosed}},[t("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"left"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left",circle:""},on:{click:function(t){e.dialogVisible=!1}}}),t("span",{staticClass:"title"},[e._v(e._s(e.title))])],1),t("div",{staticClass:"right"},[t("el-button",{attrs:{size:"small"},on:{click:e.cancalFrom}},[e._v(e._s(e.$t("h.cancelBtn")))]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sbumitForm}},[e._v(e._s(e.$t("h.confirmBtn")))])],1)]),t("div",{ref:"dialogbodyRef",staticClass:"dialog-body"},[t("div",{staticClass:"content",style:"width:"+e.contentWidth},[t("div",{staticClass:"form-label"},[e._t("form")],2),t("div",{staticClass:"table-label"},[t("div",{staticClass:"table-label-head"},[e._t("btns")],2),t("div",{staticClass:"table-label-content"},[e._t("table")],2)])])])])},l=[],s=i(63042),n={data(){return{}},props:{title:{type:String,default:s.a.t("h.title12")},newBillsDialogVisible:{type:Boolean,default:!1},contentWidth:{type:String,default:"950px"}},computed:{dialogVisible:{get(){return this.newBillsDialogVisible},set(e){this.$emit("update:newBillsDialogVisible",e)}}},methods:{cancalFrom(){this.dialogVisible=!1},sbumitForm(){this.$emit("sbumitForm")},dialogVisibleClose(){this.$emit("close"),this.$refs.dialogbodyRef.scrollTop=0},dialogVisibleClosed(){this.$emit("closed")},dialogVisibleOpened(){this.$emit("opened")}}},r=n,o=i(1001),d=(0,o.Z)(r,a,l,!1,null,"130c4832",null),c=d.exports},98884:function(e,t,i){i.d(t,{Z:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{top:"0","custom-class":"dialog","show-close":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.dialogVisibleClosed}},[t("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"left"},[t("span",[e._v(e._s(e.title))])]),t("div",{staticClass:"right"},[t("i",{staticClass:"el-icon-close",on:{click:function(t){e.dialogVisible=!1}}})])]),t("div",{staticClass:"dialog-body"},[t("ds-table",{attrs:{tableData:e.deleteErrorData,columns:e.deleteColumns,tableConfig:e.errorTableConfig}})],1)])},l=[],s=i(60983),n={components:{DsTable:s.Z},data(){return{errorTableConfig:{index:!0}}},props:{deleteDialogVisible:{type:Boolean,default:!1},deleteErrorData:{type:Array,default:()=>[]},deleteColumns:{type:Array},title:{type:String,default:"删除失败详情"}},computed:{dialogVisible:{get(){return this.deleteDialogVisible},set(e){this.$emit("update:deleteDialogVisible",e)}}},methods:{dialogVisibleClosed(){this.$emit("closed")}}},r=n,o=i(1001),d=(0,o.Z)(r,a,l,!1,null,"3e3e8f93",null),c=d.exports},93082:function(e,t,i){i.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-pagination"},[t("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},l=[],s={name:"DsPagination",data(){return{}},props:{total:{required:!0,type:Number},pageSizes:{type:Array,default(){return[20,50,100]}},page:{type:Number,default:1},limit:{type:Number,default:20},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0}},computed:{currentPage:{get(){return this.page},set(e){this.$emit("update:page",e)}},pageSize:{get(){return this.limit},set(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange(e){this.$emit("pagination",{page:this.currentPage,limit:e})},handleCurrentChange(e){this.$emit("pagination",{page:e,limit:this.pageSize})}}},n=s,r=i(1001),o=(0,r.Z)(n,a,l,!1,null,"2377c114",null),d=o.exports},92003:function(e,t,i){i.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"left-panel"},[e._t("default")],2)},l=[],s={name:"DsQueryFormLeftPanel"},n=s,r=i(1001),o=(0,r.Z)(n,a,l,!1,null,"71d76034",null),d=o.exports},89782:function(e,t,i){i.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"right-panel"},[e._t("default")],2)},l=[],s={name:"DsQueryFormRightPanel"},n=s,r=i(1001),o=(0,r.Z)(n,a,l,!1,null,"c6443ba6",null),d=o.exports},19698:function(e,t,i){i.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-query-form"},[e._t("default")],2)},l=[],s={name:"DsQueryForm"},n=s,r=i(1001),o=(0,r.Z)(n,a,l,!1,null,"6c8bfb78",null),d=o.exports},42228:function(e,t,i){i.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-search"},[t("el-input",{attrs:{size:e.size,placeholder:e.$t("h.keyword"),"prefix-icon":"el-icon-search"},model:{value:e.searchValue,callback:function(t){e.searchValue="string"===typeof t?t.trim():t},expression:"searchValue"}})],1)},l=[],s={name:"DsSearch",props:{value:{type:String},size:{type:String,default:"mini"}},computed:{searchValue:{get(){return this.value},set(e){this.$emit("update:value",e)}}},methods:{}},n=s,r=i(1001),o=(0,r.Z)(n,a,l,!1,null,"3e961102",null),d=o.exports},30385:function(e,t,i){i.r(t),i.d(t,{default:function(){return S}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"task"},[t("el-card",{staticClass:"task-card"},[t("el-tabs",{staticClass:"task-tabs-box",attrs:{"before-leave":e.tabsClassBeforeLeave},model:{value:e.classActiveName,callback:function(t){e.classActiveName=t},expression:"classActiveName"}},[t("el-tab-pane",{attrs:{label:e.$t("h.asset"),name:"asset"}},[t("el-tabs",{staticClass:"task-tabs",attrs:{"before-leave":e.tabsBeforeLeave},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("h.pending"),name:"pending"}},[t("div",{staticClass:"pending-header"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-circle-check",disabled:e.isDisabled},on:{click:e.resolvelPendingBills}},[e._v(e._s(e.$t("h.passBtn")))]),t("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-circle-close",disabled:e.isDisabled},on:{click:e.rejectPendingBills}},[e._v(e._s(e.$t("h.rejectBtn")))])],1),t("ds-query-form-right-panel",[t("el-select",{attrs:{size:"mini",filterable:"",placeholder:e.$t("h.tips4")+e.$t("h.doucmentType")},on:{change:e.getPendingBills},model:{value:e.pendingBillsType,callback:function(t){e.pendingBillsType=t},expression:"pendingBillsType"}},e._l(e.billTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("ds-search",{attrs:{value:e.pendingSearchValue},on:{"update:value":function(t){e.pendingSearchValue=t}}})],1)],1)],1),t("div",{staticClass:"pending-content"},[t("div",{staticClass:"bills-table"},[t("ds-table",{ref:"pendingTableRef",attrs:{loading:e.pendingLoading,tableConfig:e.pendingTableConfig,columns:e.billsColums,tableData:e.pendingTables.slice((e.pendingPagForm.currentPage-1)*e.pendingPagForm.pageSize,e.pendingPagForm.currentPage*e.pendingPagForm.pageSize),rowKey:e=>e.roleRule},on:{handleSelectionChange:e.handleSelectionChange,checkTableRowDetail:e.checkBillDetail}})],1),t("div",{staticClass:"bills-pagination"},[t("ds-pagination",{attrs:{small:"",total:e.pendingTables.length,page:e.pendingPagForm.currentPage,limit:e.pendingPagForm.pageSize},on:{"update:page":function(t){return e.$set(e.pendingPagForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.pendingPagForm,"pageSize",t)},pagination:e.getPendingBills}})],1)])]),t("el-tab-pane",{attrs:{label:e.$t("h.approved"),name:"finished"}},[t("div",{staticClass:"finished-header"},[t("ds-query-form",[t("ds-query-form-left-panel"),t("ds-query-form-right-panel",[t("el-select",{attrs:{size:"mini",filterable:"",placeholder:e.$t("h.tips4")+e.$t("h.doucmentType")},on:{change:e.getFinishedBills},model:{value:e.finishedBillsType,callback:function(t){e.finishedBillsType=t},expression:"finishedBillsType"}},e._l(e.billTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("ds-search",{attrs:{value:e.finishedSearchValue},on:{"update:value":function(t){e.finishedSearchValue=t}}})],1)],1)],1),t("div",{staticClass:"finished-content"},[t("div",{staticClass:"bills-table"},[t("ds-table",{ref:"finishedTableRef",attrs:{loading:e.finishedLoading,tableConfig:{},columns:e.billsColums,tableData:e.finishedTables.slice((e.finishedPagForm.currentPage-1)*e.finishedPagForm.pageSize,e.finishedPagForm.currentPage*e.finishedPagForm.pageSize),rowKey:e=>e.roleRule},on:{checkTableRowDetail:e.checkBillDetail}})],1),t("div",{staticClass:"bills-pagination"},[t("ds-pagination",{attrs:{small:"",total:e.finishedTables.length,page:e.finishedPagForm.currentPage,limit:e.finishedPagForm.pageSize},on:{"update:page":function(t){return e.$set(e.finishedPagForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.finishedPagForm,"pageSize",t)},pagination:e.getFinishedBills}})],1)])])],1)],1),t("el-tab-pane",{attrs:{label:e.$t("h.material"),name:"article"}},[t("el-tabs",{staticClass:"task-tabs",attrs:{"before-leave":e.articleTabsBeforeLeave},model:{value:e.articleActiveName,callback:function(t){e.articleActiveName=t},expression:"articleActiveName"}},[t("el-tab-pane",{attrs:{label:e.$t("h.pending"),name:"pending"}},[t("div",{staticClass:"pending-header"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-circle-check",disabled:e.articleIsDisabled},on:{click:e.articleResolvelPendingBills}},[e._v(e._s(e.$t("h.passBtn")))]),t("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-circle-close",disabled:e.articleIsDisabled},on:{click:e.articleRejectPendingBills}},[e._v(e._s(e.$t("h.rejectBtn")))])],1),t("ds-query-form-right-panel",[t("el-select",{attrs:{size:"mini",filterable:"",placeholder:e.$t("h.tips4")+e.$t("h.doucmentType")},on:{change:e.getArticlePendingBills},model:{value:e.articlePendingBillsType,callback:function(t){e.articlePendingBillsType=t},expression:"articlePendingBillsType"}},e._l(e.articleBillTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("ds-search",{attrs:{value:e.articlePendingSearchValue},on:{"update:value":function(t){e.articlePendingSearchValue=t}}})],1)],1)],1),t("div",{staticClass:"pending-content"},[t("div",{staticClass:"bills-table"},[t("ds-table",{ref:"articlePendingTableRef",attrs:{loading:e.articlePendingLoading,tableConfig:e.pendingTableConfig,columns:e.articleBillsColums,tableData:e.articlePendingTables.slice((e.articlePendingPagForm.currentPage-1)*e.articlePendingPagForm.pageSize,e.articlePendingPagForm.currentPage*e.articlePendingPagForm.pageSize),rowKey:e=>e.roleRule},on:{handleSelectionChange:e.handleArticleSelectionChange,checkTableRowDetail:e.checkArticleBillDetail}})],1),t("div",{staticClass:"bills-pagination"},[t("ds-pagination",{attrs:{small:"",total:e.articlePendingTables.length,page:e.articlePendingPagForm.currentPage,limit:e.articlePendingPagForm.pageSize},on:{"update:page":function(t){return e.$set(e.articlePendingPagForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.articlePendingPagForm,"pageSize",t)},pagination:e.getArticlePendingBills}})],1)])]),t("el-tab-pane",{attrs:{label:e.$t("h.approved"),name:"finished"}},[t("div",{staticClass:"finished-header"},[t("ds-query-form",[t("ds-query-form-left-panel"),t("ds-query-form-right-panel",[t("el-select",{attrs:{size:"mini",filterable:"",placeholder:e.$t("h.tips4")+e.$t("h.doucmentType")},on:{change:e.getArticleFinishedBills},model:{value:e.articleFinishedBillsType,callback:function(t){e.articleFinishedBillsType=t},expression:"articleFinishedBillsType"}},e._l(e.articleBillTypes,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("ds-search",{attrs:{value:e.articleFinishedSearchValue},on:{"update:value":function(t){e.articleFinishedSearchValue=t}}})],1)],1)],1),t("div",{staticClass:"finished-content"},[t("div",{staticClass:"bills-table"},[t("ds-table",{ref:"finishedTableRef",attrs:{loading:e.articleFinishedLoading,tableConfig:{},columns:e.articleBillsColums,tableData:e.articleFinishedTables.slice((e.articleFinishedPagForm.currentPage-1)*e.articleFinishedPagForm.pageSize,e.articleFinishedPagForm.currentPage*e.articleFinishedPagForm.pageSize),rowKey:e=>e.roleRule},on:{checkTableRowDetail:e.checkArticleBillDetail}})],1),t("div",{staticClass:"bills-pagination"},[t("ds-pagination",{attrs:{small:"",total:e.articleFinishedTables.length,page:e.articleFinishedPagForm.currentPage,limit:e.articleFinishedPagForm.pageSize},on:{"update:page":function(t){return e.$set(e.articleFinishedPagForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.articleFinishedPagForm,"pageSize",t)},pagination:e.getArticleFinishedBills}})],1)])])],1)],1)],1)],1),t("ds-delete-detail",{attrs:{title:e.$t("h.title108"),deleteDialogVisible:e.deleteDialogVisible,deleteColumns:e.deleteColumns,deleteErrorData:e.deleteErrorData},on:{"update:deleteDialogVisible":function(t){e.deleteDialogVisible=t},"update:delete-dialog-visible":function(t){e.deleteDialogVisible=t},closed:e.deleteDialogVisibleClosed}}),t("new-bills-dialog",{staticClass:"new-bill-dialog",attrs:{title:e.$t("h.title109"),newBillsDialogVisible:e.reasonDialogVisible},on:{"update:newBillsDialogVisible":function(t){e.reasonDialogVisible=t},"update:new-bills-dialog-visible":function(t){e.reasonDialogVisible=t},closed:e.reasonDialogVisibleClosed,sbumitForm:e.reasonDialogVisibleSubmit}},[t("template",{slot:"form"},[t("el-input",{attrs:{type:"textarea",placeholder:e.$t("h.tips3")+e.$t("h.title110"),"show-word-limit":"",rows:"5"},model:{value:e.rejectReason,callback:function(t){e.rejectReason=t},expression:"rejectReason"}})],1)],2),t("bill-detail-dialog",{attrs:{billDetailDialogVisible:e.billDetailDialogVisible,billFormDetail:e.billFormDetail,auditStep:e.auditStep},on:{"update:billDetailDialogVisible":function(t){e.billDetailDialogVisible=t},"update:bill-detail-dialog-visible":function(t){e.billDetailDialogVisible=t},closed:e.billDetailDialogVisibleClosed}},[t("template",{slot:"table"},[t("ds-table",{ref:"detailTableRef",attrs:{loading:e.detailLoading,tableData:e.detailAssets,columns:e.billAssetsColumns,tableConfig:e.detailConfig,rowKey:e=>e._id}})],1),t("template",{slot:"pagination"},[t("ds-pagination",{attrs:{small:"",total:e.detailTotal,page:e.detailPaginationForm.currentPage,limit:e.detailPaginationForm.pageSize},on:{"update:page":function(t){return e.$set(e.detailPaginationForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.detailPaginationForm,"pageSize",t)},pagination:e.detailPagination}})],1)],2),t("bill-detail-dialog",{attrs:{billDetailDialogVisible:e.articleBillDetailDialogVisible,billFormDetail:e.articleBillFormDetail,auditStep:e.auditStep},on:{"update:billDetailDialogVisible":function(t){e.articleBillDetailDialogVisible=t},"update:bill-detail-dialog-visible":function(t){e.articleBillDetailDialogVisible=t},closed:e.articleBillDetailDialogVisibleClosed}},[t("template",{slot:"table"},[t("ds-table",{ref:"articleDetailTableRef",attrs:{loading:e.articleDetailLoading,tableData:e.detailArticle,columns:e.articleBillAssetsColumns,tableConfig:e.detailConfig,rowKey:e=>e._id}})],1),t("template",{slot:"pagination"},[t("ds-pagination",{attrs:{small:"",total:e.articleDetailTotal,page:e.articleDetailPaginationForm.currentPage,limit:e.articleDetailPaginationForm.pageSize},on:{"update:page":function(t){return e.$set(e.articleDetailPaginationForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.articleDetailPaginationForm,"pageSize",t)},pagination:e.detailPagination}})],1)],2)],1)},l=[],s=(i(57658),i(78067)),n=i(42041),r=i(98884),o=i(42228),d=i(60983),c=i(93082),h=i(19698),g=i(92003),u=i(89782),p=i(20629),f=i(83151),m=i(79992),b=i(76080),D={components:{BillDetailDialog:s.Z,NewBillsDialog:n.Z,DsDeleteDetail:r.Z,DsSearch:o.Z,DsTable:d.Z,DsPagination:c.Z,DsQueryForm:h.Z,DsQueryFormLeftPanel:g.Z,DsQueryFormRightPanel:u.Z},data(){return{activeName:"pending",billTypes:f.Rg,pendingBillsType:"0",finishedBillsType:"0",billsColums:f.j,pendingPagForm:{currentPage:1,pageSize:20},pendingLoading:!1,pendingTableConfig:{selection:!0,reserveSelection:!0},pendingBills:[],selectpendingBills:[],finishedPagForm:{currentPage:1,pageSize:20},finishedLoading:!1,finishedBills:[],pendingSearchValue:"",finishedSearchValue:"",deleteDialogVisible:!1,deleteColumns:f.a7,deleteErrorData:[],reasonDialogVisible:!1,dialogLoading:{target:".new-bill-dialog",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"},rejectReason:"",billDetailDialogVisible:!1,billFormDetail:[],auditStep:[],detailLoading:!1,detailAssets:[],detailMatchAssetIds:[],detailConfig:{},detailTotal:0,detailPaginationForm:{currentPage:1,pageSize:20},classActiveName:"asset",articleActiveName:"pending",articleBillTypes:f.VP,articlePendingBillsType:"ALL",articleFinishedBillsType:"ALL",articleBillsColums:f.t$,articlePendingPagForm:{currentPage:1,pageSize:20},articlePendingLoading:!1,articlePendingBills:[],articleSelectpendingBills:[],articleFinishedPagForm:{currentPage:1,pageSize:20},articleFinishedLoading:!1,articleFinishedBills:[],articlePendingSearchValue:"",articleFinishedSearchValue:"",articleDeleteColumns:f.b_,articleDeleteErrorData:[],articleBillDetailDialogVisible:!1,articleBillFormDetail:[],articleDetailLoading:!1,detailArticle:[],detailArticleMatchAssetIds:[],articleDetailTotal:0,articleDetailPaginationForm:{currentPage:1,pageSize:20}}},computed:{...(0,p.rn)(["userInfo","assetTableHeader"]),billAssetsColumns(){let e=[];return this.assetTableHeader.forEach((t=>{"assetCode"==t.attr||"type"==t.attr||"name"==t.attr||"model"==t.attr||"assertPosition"==t.attr?e.push({prop:t.attr,label:t.label,fixed:t.fixed,minWidth:(0,m.Uh)(t.label),showOverflowTooltip:!0}):"photo"==t.attr&&e.push({type:"image",prop:t.attr,label:t.label,fixed:t.fixed,width:(0,m.Uh)(t.label)})})),e},isDisabled(){return!this.selectpendingBills.length},pendingTables(){const e=this.pendingSearchValue;return e?this.pendingBills.filter((t=>Object.keys(t).some((i=>String(t[i]).indexOf(e)>-1)))):this.pendingBills},finishedTables(){const e=this.finishedSearchValue;return e?this.finishedBills.filter((t=>Object.keys(t).some((i=>String(t[i]).indexOf(e)>-1)))):this.finishedBills},articleBillAssetsColumns(){let e=[];return e.push({prop:"code",label:this.$t("h.title166"),fixed:"fixed",minWidth:(0,m.Uh)(this.$t("h.title166")),showOverflowTooltip:!0}),e.push({prop:"name",label:this.$t("h.formTips38"),fixed:"fixed",minWidth:(0,m.Uh)(this.$t("h.formTips38")),showOverflowTooltip:!0}),e.push({prop:"specification",label:this.$t("h.tips48"),fixed:"fixed",minWidth:(0,m.Uh)(this.$t("h.tips48")),showOverflowTooltip:!0}),e.push({prop:"epc",label:"epc",fixed:"fixed",minWidth:(0,m.Uh)("epc"),showOverflowTooltip:!0}),e.push({prop:"price",label:this.$t("h.price"),fixed:"fixed",minWidth:(0,m.Uh)(this.$t("h.price")),showOverflowTooltip:!0}),e.push({type:"image",prop:"image",label:this.$t("h.columns71"),fixed:"fixed",width:(0,m.Uh)(this.$t("h.columns71"))}),e},articleIsDisabled(){return!this.articleSelectpendingBills.length},articlePendingTables(){const e=this.articlePendingSearchValue;return e?this.articlePendingBills.filter((t=>Object.keys(t).some((i=>String(t[i]).indexOf(e)>-1)))):this.articlePendingBills},articleFinishedTables(){const e=this.articleFinishedSearchValue;return e?this.articleFinishedBills.filter((t=>Object.keys(t).some((i=>String(t[i]).indexOf(e)>-1)))):this.articleFinishedBills}},methods:{mapFunc(e){e.forEach((e=>{switch(e.roleRule.slice(0,2)){case"LY":e.type=this.$t("h.columns16"),e.applyDate=e.receiveData,e.typeStr="LY";break;case"TK":e.type=this.$t("h.columns17"),e.applyDate=e.date,e.typeStr="TK";break;case"JY":e.type=this.$t("h.columns18"),e.applyDate=e.borrowData,e.typeStr="JY";break;case"BF":e.type=this.$t("h.columns19"),e.applyDate=e.destroyData,e.typeStr="BF";break;case"WX":e.type=this.$t("h.columns20"),e.applyDate=e.receiveData,e.typeStr="WX";break;case"ZY":e.type=this.$t("h.columns21"),e.applyDate=e.date,e.typeStr="ZY";break;case"RK":e.type=this.$t("h.columns22"),e.applyDate=e.estaDate,e.typeStr="RK";break;case"GH":e.type=this.$t("h.columns23"),e.applyDate=e.date,e.typeStr="GH"}}))},articleMapFunc(e){e.forEach((e=>{switch(e.roleRule.slice(0,2)){case"TK":e.type=this.$t("h.title234"),e.applyDate=e.receiveData,e.typeStr="TK";break;case"RK":e.type=this.$t("h.title235"),e.applyDate=e.date,e.typeStr="RK";break;case"CK":e.type=this.$t("h.title236"),e.applyDate=e.borrowData,e.typeStr="CK";break;case"TZ":e.type=this.$t("h.title237"),e.applyDate=e.destroyData,e.typeStr="TZ";break;case"DB":e.type=this.$t("h.title238"),e.applyDate=e.receiveData,e.typeStr="DB";break}}))},tabsClassBeforeLeave(e){"asset"==e?"finished"==this.activeName?this.getFinishedBills():this.getPendingBills():"finished"==this.articleActiveName?this.getArticleFinishedBills():this.getArticlePendingBills()},getPendingBills(){this.pendingLoading=!0,(0,b.Ys)({func:"S0023",userId:this.userInfo._id,token:this.userInfo.token,requstData:{assetUpId:this.pendingBillsType}}).then((({data:e})=>{if(this.pendingLoading=!1,0!=e.code)return this.$message.error(e.data);e.data instanceof Array?(this.mapFunc(e.data),e.data.forEach((e=>{if(e.asset){let t=[];e.asset.forEach((e=>{t.push(e.name)})),e.assetNames=t.join(",")}})),e.data.sort(((e,t)=>t.applyDate>e.applyDate?1:-1)),this.pendingBills=e.data):this.pendingBills=[]})).catch((e=>{console.log(e),this.pendingLoading=!1,this.$message.error(this.$t("h.tips18"))}))},handleSelectionChange(e){this.selectpendingBills=e},getFinishedBills(){this.finishedLoading=!0,(0,b.Ys)({func:"S0025",userId:this.userInfo._id,token:this.userInfo.token,requstData:{assetUpId:this.finishedBillsType}}).then((({data:e})=>{if(console.log(e),this.finishedLoading=!1,0!=e.code)return this.$message.error(e.data);"无已审核任务"==e.data?e.data=[]:(this.mapFunc(e.data),e.data.forEach((e=>{if(e.asset){let t=[];e.asset.forEach((e=>{t.push(e.name)})),e.assetNames=t.join(",")}})),e.data.sort(((e,t)=>t.applyDate>e.applyDate?1:-1))),this.finishedBills=e.data})).catch((e=>{console.log(e),this.finishedLoading=!1,this.$message.error(this.$t("h.tips18"))}))},tabsBeforeLeave(e){"finished"==e?this.getFinishedBills():this.getPendingBills()},getArticlePendingBills(){this.articlePendingLoading=!0,(0,b.C3)({func:"NEX0001",userId:this.userInfo._id,token:this.userInfo.token,requstData:{result:this.articlePendingBillsType}}).then((({data:e})=>{if(this.articlePendingLoading=!1,0!=e.code)return this.$message.error(e.data);e.data instanceof Array?(this.articleMapFunc(e.data),e.data.forEach((e=>{if(e.list){let t=[];e.list.forEach((e=>{t.push(e.name)})),e.materialNames=t.join(",")}})),e.data.sort(((e,t)=>t.applyDate>e.applyDate?1:-1)),this.articlePendingBills=e.data):this.articlePendingBills=[]})).catch((e=>{console.log(e),this.articlePendingLoading=!1,this.$message.error(this.$t("h.tips18"))}))},handleArticleSelectionChange(e){this.articleSelectpendingBills=e},getArticleFinishedBills(){this.articleFinishedLoading=!0,(0,b.C3)({func:"YEX0001",userId:this.userInfo._id,token:this.userInfo.token,requstData:{result:this.articleFinishedBillsType}}).then((({data:e})=>{if(this.articleFinishedLoading=!1,0!=e.code)return this.$message.error(e.data);"无已审核任务"!=e.data&&e.data?(this.articleMapFunc(e.data),e.data.forEach((e=>{if(e.list){let t=[];e.list.forEach((e=>{t.push(e.name)})),e.materialNames=t.join(",")}})),e.data.sort(((e,t)=>t.applyDate>e.applyDate?1:-1))):e.data=[],this.articleFinishedBills=e.data})).catch((e=>{console.log(e),this.articleFinishedLoading=!1,this.$message.error(this.$t("h.tips18"))}))},articleTabsBeforeLeave(e){"finished"==e?this.getArticleFinishedBills():this.getArticlePendingBills()},deleteDialogVisibleClosed(){this.deleteErrorData=[]},resolvelPendingBills(){this.pendingLoading=!0,this.deleteErrorData=[];let e=(0,m.p5)(this.selectpendingBills,"typeStr");this.multiPassBill(0,e)},multiPassBill(e,t){if(e>t.length-1)return this.pendingPagForm.currentPage=1,this.getPendingBills(),this.$refs["pendingTableRef"].$refs["dsTableRef"].clearSelection(),void(this.deleteErrorData.length?this.deleteDialogVisible=!0:this.$message.success(this.$t("h.tips181")));console.log(e);let i=[],a="";t[e].forEach(((e,t)=>{0==t&&"LY"==e.roleRule.slice(0,2)?a="1":0==t&&"TK"==e.roleRule.slice(0,2)?a="2":0==t&&"JY"==e.roleRule.slice(0,2)?a="3":0==t&&"BF"==e.roleRule.slice(0,2)?a="4":0==t&&"WX"==e.roleRule.slice(0,2)?a="5":0==t&&"ZY"==e.roleRule.slice(0,2)?a="6":0==t&&"RK"==e.roleRule.slice(0,2)?a="7":0==t&&"GH"==e.roleRule.slice(0,2)&&(a="8"),"GH"==e.roleRule.slice(0,2)?i.push(e.revertId):i.push(e._id)})),(0,b.Vx)({func:"U0025",userId:this.userInfo._id,token:this.userInfo.token,requstData:{housOutIds:i.join(","),signatureId:this.userInfo._id,assetUpId:a,permissonId:67}}).then((({data:i})=>{0!=i.code&&this.deleteErrorData.push({type:a,reason:i.data}),this.multiPassBill(++e,t)})).catch((()=>{this.deleteErrorData.push({type:a,reason:this.$t("h.tips18")}),this.multiPassBill(++e,t)}))},rejectPendingBills(){this.reasonDialogVisible=!0},articleResolvelPendingBills(){this.articlePendingLoading=!0;let e=(0,m.p5)(this.articleSelectpendingBills,"typeStr"),t=[];e.forEach((e=>{let i=[],a="";e.forEach(((e,t)=>{0==t&&"CYS"==e.roleRule.slice(0,3)?a="TK":0==t&&"CIS"==e.roleRule.slice(0,3)?a="RK":0==t&&"CRE"==e.roleRule.slice(0,3)?a="CK":0==t&&"CAS"==e.roleRule.slice(0,3)?a="TZ":0==t&&"CTR"==e.roleRule.slice(0,3)&&(a="DB"),e.allocateId?i.push(e.allocateId):e.adjustId?i.push(e.adjustId):i.push(e.warehousingId)})),t.push(new Promise(((e,t)=>{(0,b.C3)({func:"EX0001",userId:this.userInfo._id,token:this.userInfo.token,requstData:{result:0,id:i.join(","),types:a}}).then((({data:i})=>{0!=i.code&&t({type:a,reason:i.data}),e(i)})).catch((()=>{t({type:a,reason:this.$t("h.tips18")})}))})))})),Promise.allSettled(t).then((e=>{let t=e.filter((e=>"rejected"==e.status));t.length?(t.forEach((e=>{this.articleDeleteErrorData.push(e.reason)})),this.articlePendingPagForm.currentPage=1,this.getArticlePendingBills(),this.$refs["articlePendingTableRef"].$refs["dsTableRef"].clearSelection(),this.articleDeleteDialogVisible=!0):(this.articlePendingPagForm.currentPage=1,this.getArticlePendingBills(),this.$refs["articlePendingTableRef"].$refs["dsTableRef"].clearSelection(),this.$message.success(this.$t("h.tips181")))}))},articleRejectPendingBills(){this.articlePendingLoading=!0;let e=(0,m.p5)(this.articleSelectpendingBills,"typeStr"),t=[];e.forEach((e=>{let i=[],a="";e.forEach(((e,t)=>{0==t&&"CYS"==e.roleRule.slice(0,3)?a="TK":0==t&&"CIS"==e.roleRule.slice(0,3)?a="RK":0==t&&"CRE"==e.roleRule.slice(0,3)?a="CK":0==t&&"CAS"==e.roleRule.slice(0,3)?a="TZ":0==t&&"CTR"==e.roleRule.slice(0,3)&&(a="DB"),e.allocateId?i.push(e.allocateId):e.adjustId?i.push(e.adjustId):i.push(e.warehousingId)})),t.push(new Promise(((e,t)=>{(0,b.C3)({func:"EX0001",userId:this.userInfo._id,token:this.userInfo.token,requstData:{result:-2,id:i.join(","),types:a}}).then((({data:i})=>{0!=i.code&&t({type:a,reason:i.data}),e(i)})).catch((()=>{t({type:a,reason:this.$t("h.tips18")})}))})))})),Promise.allSettled(t).then((e=>{let t=e.filter((e=>"rejected"==e.status));t.length?(t.forEach((e=>{this.articleDeleteErrorData.push(e.reason)})),this.articlePendingPagForm.currentPage=1,this.getArticlePendingBills(),this.$refs["articlePendingTableRef"].$refs["dsTableRef"].clearSelection(),this.articleDeleteDialogVisible=!0):(this.articlePendingPagForm.currentPage=1,this.getArticlePendingBills(),this.$refs["articlePendingTableRef"].$refs["dsTableRef"].clearSelection(),this.$message.success(this.$t("h.tips270")))}))},reasonDialogVisibleClosed(){this.rejectReason=""},reasonDialogVisibleSubmit(){const e=this.$loading(this.dialogLoading);this.deleteErrorData=[];let t=(0,m.p5)(this.selectpendingBills,"typeStr");this.multiRejectBill(0,t,e)},multiRejectBill(e,t,i){if(e>t.length-1)return i.close(),this.reasonDialogVisible=!1,this.pendingPagForm.currentPage=1,this.getPendingBills(),this.$refs["pendingTableRef"].$refs["dsTableRef"].clearSelection(),void(this.deleteErrorData.length?this.deleteDialogVisible=!0:this.$message.success(this.$t("h.tips181")));let a=[],l="";t[e].forEach(((e,t)=>{0==t&&"LY"==e.roleRule.slice(0,2)?l="1":0==t&&"TK"==e.roleRule.slice(0,2)?l="2":0==t&&"JY"==e.roleRule.slice(0,2)?l="3":0==t&&"BF"==e.roleRule.slice(0,2)?l="4":0==t&&"WX"==e.roleRule.slice(0,2)?l="5":0==t&&"ZY"==e.roleRule.slice(0,2)?l="6":0==t&&"RK"==e.roleRule.slice(0,2)?l="7":0==t&&"GH"==e.roleRule.slice(0,2)&&(l="8"),"GH"==e.roleRule.slice(0,2)?a.push(e.revertId):a.push(e._id)})),(0,b.Vx)({func:"U0025",userId:this.userInfo._id,token:this.userInfo.token,requstData:{housOutIds:a.join(","),signatureId:"-1",assetUpId:l,permissonId:67,rejection:this.rejectReason}}).then((({data:a})=>{0!=a.code&&this.deleteErrorData.push({type:l,reason:a.data}),this.multiRejectBill(++e,t,i)})).catch((()=>{this.deleteErrorData.push({type:l,reason:this.$t("h.tips18")}),this.multiRejectBill(++e,t,i)}))},billDetailDialogVisibleClosed(){this.detailAssets=[],this.detailTotal=0,this.detailPaginationForm.currentPage=1,this.detailPaginationForm.pageSize=20,this.detailMatchAssetIds=[]},articleBillDetailDialogVisibleClosed(){this.detailArticle=[],this.articleDetailTotal=0,this.articleDetailPaginationForm.currentPage=1,this.articleDetailPaginationForm.pageSize=20,this.detailArticleMatchAssetIds=[]},checkBillDetail(e){"LY"==e.typeStr?this.billFormDetail=(0,f.oH)(e):"TK"==e.typeStr?this.billFormDetail=(0,f.bF)(e):"JY"==e.typeStr?this.billFormDetail=(0,f.r7)(e):"BF"==e.typeStr?this.billFormDetail=(0,f.v0)(e):"WX"==e.typeStr?this.billFormDetail=(0,f.EL)(e):"ZY"==e.typeStr?this.billFormDetail=(0,f.iG)(e):"RK"==e.typeStr?this.billFormDetail=(0,f.c5)(e):"GH"==e.typeStr&&(this.billFormDetail=(0,f.NZ)(e)),"RK"==e.typeStr?(this.detailTotal=e.asset.length,this.detailMatchAssets=e.asset,this.rkDetailPagination()):(this.detailMatchAssetIds=e.assetIds.split(","),this.detailMatchAssetIds.length&&(this.detailTotal=this.detailMatchAssetIds.length,this.detailPagination(e))),this.getBillsAuditMessage(e),this.billDetailDialogVisible=!0},checkArticleBillDetail(e){let t={};e.allocateId?t._id=e.allocateId:e.adjustId?t._id=e.adjustId:t._id=e.warehousingId,t.examineOne=e.examineOne,t.examineTwo=e.examineTwo,t.examineThree=e.examineThree,t.examineFour=e.examineFour,t.examineFive=e.examineFive,"CYS"==e.roleRule.slice(0,3)?(t.typeStr="CKTK",this.articleBillFormDetail=(0,f.oe)(e)):"CIS"==e.roleRule.slice(0,3)?(t.typeStr="CKRK",this.articleBillFormDetail=(0,f.MH)(e)):"CRE"==e.roleRule.slice(0,3)?(t.typeStr="CKCK",this.articleBillFormDetail=(0,f.bE)(e)):"CAS"==e.roleRule.slice(0,3)?(t.typeStr="CKTZ",this.articleBillFormDetail=(0,f.a2)(e)):"CTR"==e.roleRule.slice(0,3)&&(t.typeStr="CKDB",this.articleBillFormDetail=(0,f._D)(e)),this.articleDetailTotal=e.details.length,this.detailArticleMatchAssetIds=e.list,this.articleDetailPagination(),this.getBillsAuditMessage(t),this.articleBillDetailDialogVisible=!0},getBillsAuditMessage(e){let t=null;t="GH"==e.typeStr?e.revertId:e._id,(0,b.Ys)({func:"S0053",token:this.userInfo.token,userId:this.userInfo._id,requstData:{_id:t,type:e.typeStr}}).then((({data:t})=>{if(0!=t.code)return this.$message.error(t.data);this.auditStep=this.createBillAuditMessage(e,t.data)})).catch((()=>{this.$message.error(this.$t("h.tips18"))}))},createBillAuditMessage(e,t){let i=[];return e.examineOne&&i.push({state:"pedding",auditStaffName:this.$t("h.auditStaffName1"),auditState:"more"}),e.examineTwo&&i.push({state:"pedding",auditStaffName:this.$t("h.auditStaffName2"),auditState:"more"}),e.examineThree&&i.push({state:"pedding",auditStaffName:this.$t("h.auditStaffName3"),auditState:"more"}),e.examineFour&&i.push({state:"pedding",auditStaffName:this.$t("h.auditStaffName4"),auditState:"more"}),e.examineFive&&i.push({state:"pedding",auditStaffName:this.$t("h.auditStaffName5"),auditState:"more"}),i.forEach(((e,i)=>{if(t[i])if(void 0!=t[i].rejection){for(let a in t[i])"rejection"!=a&&(e.auditStaffName=t[i][a]);e.auditState="error",e.message=t[i].rejection}else{for(let a in t[i])"rejection"!=a&&(e.auditStaffName=t[i][a]);e.auditState="success"}})),i.push({state:"end"}),i},detailPagination(e){let t=this.detailMatchAssetIds.slice((this.detailPaginationForm.currentPage-1)*this.detailPaginationForm.pageSize,this.detailPaginationForm.currentPage*this.detailPaginationForm.pageSize);this.getMatchAssets(t.join(","),e)},rkDetailPagination(){this.detailLoading=!0,this.detailAssets=this.detailMatchAssets.slice((this.detailPaginationForm.currentPage-1)*this.detailPaginationForm.pageSize,this.detailPaginationForm.currentPage*this.detailPaginationForm.pageSize),this.detailLoading=!1},articleDetailPagination(){this.articleDetailLoading=!0,this.detailArticle=this.detailArticleMatchAssetIds.slice((this.articleDetailPaginationForm.currentPage-1)*this.articleDetailPaginationForm.pageSize,this.articleDetailPaginationForm.currentPage*this.articleDetailPaginationForm.pageSize),this.articleDetailLoading=!1},getMatchAssets(e,t){this.detailLoading=!0,this.$nextTick((()=>{this.$refs.detailTableRef.$refs.dsTableRef.bodyWrapper.scrollTop=0})),(0,b.Ys)({func:"S0007",userId:this.userInfo._id,token:this.userInfo.token,requstData:{item:[{key:"_id",handle:"OIS",value:e}]}}).then((({data:e})=>{if(this.detailLoading=!1,0!=e.code)return this.$message.error(e.data);this.detailAssets=e.data;const i=t.jsonDate,a=t.jsonUser;for(let t in i)this.detailAssets.forEach((e=>{e._id==t&&(e.returnWareDate=i[t])}));for(let t in a)this.detailAssets.forEach((e=>{e._id==t&&(e.returnWareUser=a[t])}))})).catch((()=>{this.detailLoading=!1,this.$message.error(this.$t("h.tips18"))}))}},created(){this.getPendingBills()}},P=D,y=i(1001),v=(0,y.Z)(P,a,l,!1,null,"7388f2da",null),S=v.exports},36108:function(e,t,i){e.exports=i.p+"img/head-portrait.860b5e9d.png"}}]);