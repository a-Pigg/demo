"use strict";(self["webpackChunk_4010_assetweb"]=self["webpackChunk_4010_assetweb"]||[]).push([[3838],{49134:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"Warehousing"},[t("el-card",{staticClass:"card"},[t("div",{staticClass:"header"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.newBillsDialogVisible=!0}}},[e._v(e._s(e.$t("h.newBtn")))]),t("el-dropdown",{attrs:{trigger:"click",disabled:e.assetTableSelectData.length<=0},on:{command:e.editingOperations}},[t("el-button",{attrs:{size:"small"}},[e._v(" "+e._s(e.$t("h.editBtn"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"modify"}},[e._v(e._s(e.$t("h.changeBtn")))]),t("el-dropdown-item",{attrs:{command:"delete"}},[e._v(e._s(e.$t("h.delBtn")))])],1)],1),t("el-dropdown",{staticStyle:{"margin-left":"0px"},attrs:{trigger:"click"}},[t("el-button",{attrs:{size:"small"}},[e._v(e._s(e.$t("h.formTips5"))+" "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.goPrintBills.apply(null,arguments)}}},[e._v(e._s(e.$t("h.printBtn")))]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openPrintSet.apply(null,arguments)}}},[e._v(e._s(e.$t("h.tempSetBtn")))])],1)],1),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.exportFile}},[e._v(e._s(e.$t("h.exportBtn")))])],1),t("ds-query-form-right-panel",[t("ds-search-btn",{attrs:{searchValue:e.andLike},on:{"update:searchValue":function(t){e.andLike=t},"update:search-value":function(t){e.andLike=t},search:e.bodySearch}})],1)],1),t("div",{staticClass:"screen"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("ds-filter-tag",{attrs:{filterTagsData:e.highFilterTags},on:{handleCloseTag:e.handleCloseFilterTag}})],1),t("ds-query-form-right-panel",[t("span",{staticClass:"advancedSearch",on:{click:function(t){e.bodyFilteringVisible=!0}}},[e._v(e._s(e.$t("h.advancedBtn")))])])],1)],1),t("new-bills-dialog",{staticClass:"new-bill-dialog",attrs:{contentWidth:"55%",title:e.$t("h.title226"),newBillsDialogVisible:e.newBillsDialogVisible,look:e.look,warning:e.warning},on:{"update:newBillsDialogVisible":function(t){e.newBillsDialogVisible=t},"update:new-bills-dialog-visible":function(t){e.newBillsDialogVisible=t},sbumitForm:e.warehousing,close:e.bulkBillsDialogClose,opened:e.getWarehouseData,"before-close":e.bulkBillsDialogClose}},[t("template",{slot:"form"},[e.warning?t("p",{staticClass:"warning"},[e._v(" "+e._s(e.$t("h.formTips54"))+e._s(e.warningTitle)+e._s(e.$t("h.title169"))+" ")]):e._e(),t("el-row",{attrs:{gutter:45}},[t("el-form",{ref:"pushWarehouseDataRef",attrs:{"label-width":"80px",model:e.pushWarehouseData,rules:e.pushWarehouseRules,disabled:e.look}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("h.warehouseEntryNumber"),prop:"roleRule"}},[t("el-input",{attrs:{disabled:""},model:{value:e.pushWarehouseData.roleRule,callback:function(t){e.$set(e.pushWarehouseData,"roleRule",t)},expression:"pushWarehouseData.roleRule"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("h.columns50"),prop:"houseId"}},[t("el-cascader",{attrs:{options:e.warehouseData,props:{checkStrictly:!0},"show-all-levels":!1},model:{value:e.pushWarehouseData.houseId,callback:function(t){e.$set(e.pushWarehouseData,"houseId",t)},expression:"pushWarehouseData.houseId"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("h.formTips80"),prop:"useDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:e.$t("h.tips4")+e.$t("h.formTips80"),clearable:"","value-format":"yyyy-MM-dd"},model:{value:e.pushWarehouseData.useDate,callback:function(t){e.$set(e.pushWarehouseData,"useDate",t)},expression:"pushWarehouseData.useDate"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("h.supplier"),prop:"vendName"}},[t("el-input",{model:{value:e.pushWarehouseData.vendName,callback:function(t){e.$set(e.pushWarehouseData,"vendName",t)},expression:"pushWarehouseData.vendName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("h.formTips67"),prop:"staffName"}},[t("el-select",{directives:[{name:"load-more",rawName:"v-load-more",value:{options:e.staffData,modelField:"_id",model:e.staffId,searchField:"andLike",func:"S0005",userInfo:e.userInfo},expression:"{\n                      options: staffData,\n                      modelField: '_id',\n                      model: staffId,\n                      searchField: 'andLike',\n                      func: 'S0005',\n                      userInfo: userInfo,\n                    }"}],attrs:{placeholder:e.$t("h.tips4"),clearable:"",filterable:"",disabled:"","filter-method":()=>{}},model:{value:e.pushWarehouseData.staffName,callback:function(t){e.$set(e.pushWarehouseData,"staffName",t)},expression:"pushWarehouseData.staffName"}},e._l(e.staffData,(function(e){return t("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("h.formTips68"),prop:"createDate"}},[t("el-date-picker",{attrs:{disabled:"",type:"date"},model:{value:e.pushWarehouseData.createDate,callback:function(t){e.$set(e.pushWarehouseData,"createDate",t)},expression:"pushWarehouseData.createDate"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("h.comment"),prop:"remark"}},[t("el-input",{attrs:{type:"textarea",rows:"3",placeholder:e.$t("h.tips4")+e.$t("h.comment")},model:{value:e.pushWarehouseData.remark,callback:function(t){e.$set(e.pushWarehouseData,"remark",t)},expression:"pushWarehouseData.remark"}})],1)],1)],1)],1)],1),t("template",{slot:"btns"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("span",{staticClass:"advancedSearch"},[e._v(e._s(e.$t("h.title225"))+" - "+e._s(e.$t("h.title147")))])]),t("ds-query-form-right-panel",[e.look?e._e():t("el-button",{attrs:{size:"small",type:"primary",disabled:e.warning},on:{click:function(t){e.articleDialogVisible=!0}}},[e._v(e._s(e.$t("h.title171")))]),e.look?e._e():t("el-button",{attrs:{size:"small",type:"primary",disabled:e.warning},on:{click:e.deleteArticleDetailsSelete}},[e._v(e._s(e.$t("h.title172")))])],1)],1)],1),t("template",{slot:"table"},[t("div",{staticClass:"bill-table"},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.articleDetailsData,height:"400"},on:{"selection-change":e.articleDetailsSelete}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._l(e.newArticleDetailsColumns,(function(a,i){return t("el-table-column",{directives:[{name:"show",rawName:"v-show",value:a.label==e.$t("h.action"),expression:"column.label == $t('h.action')"}],key:i,attrs:{label:a.label,prop:a.prop,width:a.width||"",align:"center",fixed:a.fixed},scopedSlots:e._u([{key:"default",fn:function(i){return["image"==a.type?t("div",{staticClass:"table-image-cell"},[i.row[a.prop]?t("el-image",{attrs:{src:i.row[a.prop],"preview-src-list":[i.row[a.prop]]}}):t("div",{staticClass:"no-image"},[t("span",[e._v(e._s(e.$t("h.title51")))])])],1):e.look||"amount"!=a.slotName?e.look||"price"!=a.slotName?e.look||"money"!=a.slotName?t("div",{staticClass:"show-tooltip"},[t("span",[e._v(e._s(a.formatter?a.formatter(i.row,i.column):i.row[a.prop]))])]):[t("el-input",{attrs:{"controls-position":"right",min:0,disabled:""},model:{value:i.row[a.prop],callback:function(t){e.$set(i.row,a.prop,t)},expression:"scope.row[column.prop]"}})]:[t("el-input-number",{staticClass:"small-input",attrs:{"controls-position":"right",min:0},on:{change:function(t){return e.changeMoney(i.$index,i.row)}},model:{value:i.row[a.prop],callback:function(t){e.$set(i.row,a.prop,t)},expression:"scope.row[column.prop]"}})]:[t("el-input-number",{staticClass:"small-input",attrs:{"controls-position":"right",min:1},on:{change:function(t){return e.changeMoney(i.$index,i.row)}},model:{value:i.row[a.prop],callback:function(t){e.$set(i.row,a.prop,t)},expression:"scope.row[column.prop]"}})]]}}],null,!0)},[t("template",{slot:"header"},[t("span",{class:a.prop},[e._v(e._s(a.label))])])],2)}))],2)],1)])],2),t("el-dialog",{ref:"articleDialog",staticClass:"dialog-select-article",attrs:{title:"选择物品",visible:e.articleDialogVisible,width:"60%","before-close":e.articleDialogVisibleClose},on:{"update:visible":function(t){e.articleDialogVisible=t}}},[t("div",{staticClass:"dialog-body"},[t("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.waitFilesData,expression:"waitFilesData"}],staticClass:"el-menu-vertical-demo",attrs:{data:e.subMenuList,props:e.subMenuListProps,"highlight-current":e.highlightCurrent,"node-key":"sortingId"},on:{"node-click":e.sortingDataSwitching},scopedSlots:e._u([{key:"default",fn:function({data:a}){return t("span",{},[t("span",{staticClass:"icon"},[null==a.children?[t("svg-icon",{staticClass:"childIcon",attrs:{"icon-file-name":"childGb"}})]:[t("svg-icon",{staticClass:"parentIcon",attrs:{"icon-file-name":"gb"}})]],2),t("span",{staticClass:"text",staticStyle:{"font-size":"14px"}},[e._v(" "+e._s(a.code)+"-"+e._s(a.name)+" ")])])}}])}),t("div",{staticClass:"right"},[t("div",{staticClass:"top"},[t("ds-search-btn",{attrs:{searchValue:e.articleAndLike},on:{"update:searchValue":function(t){e.articleAndLike=t},"update:search-value":function(t){e.articleAndLike=t},search:e.articleSearch}}),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.getFilesData("showAll")}}},[e._v(e._s(e.$t("h.showAllItems")))])],1),t("div",{staticClass:"screen"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("ds-filter-tag",{attrs:{filterTagsData:e.articleHighFilterTags},on:{handleCloseTag:e.articleHandleCloseFilterTag}})],1),t("ds-query-form-right-panel",[t("span",{staticClass:"advancedSearch",on:{click:function(t){e.addFilteringVisible=!0}}},[e._v(e._s(e.$t("h.advancedBtn")))])])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.waitFilesData,expression:"waitFilesData"}],ref:"articleData",staticClass:"articleTable",attrs:{data:e.articleDataDisplay,height:"51.5vh"},on:{"selection-change":e.articleSelete}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._l(e.newArticleColumns,(function(a,i){return t("el-table-column",{key:i,attrs:{label:a.label,prop:a.prop,width:a.width||"",align:"center",fixed:a.fixed},scopedSlots:e._u([{key:"default",fn:function(i){return["image"==a.type?t("div",{staticClass:"table-image-cell"},[i.row[a.prop]?t("el-image",{attrs:{src:i.row[a.prop],"preview-src-list":[i.row[a.prop]]}}):t("div",{staticClass:"no-image"},[t("span",[e._v(e._s(e.$t("h.title51")))])])],1):t("div",{staticClass:"show-tooltip"},[t("span",[e._v(e._s(a.formatter?a.formatter(i.row,i.column):i.row[a.prop]))])])]}}],null,!0)})}))],2),t("div",{staticClass:"pagination"},[t("ds-pagination",{attrs:{small:"",total:e.articleTotal,page:e.articlePaginationForm.currentPage,limit:e.articlePaginationForm.pageSize},on:{"update:page":function(t){return e.$set(e.articlePaginationForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.articlePaginationForm,"pageSize",t)},pagination:e.articleChangeSizePage}})],1)],1)],1),t("span",{staticClass:"footer-span",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:e.outArticleDialog}},[e._v(e._s(e.$t("h.cancelBtn")))]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.determineItemSelection}},[e._v(e._s(e.$t("h.confirmBtn")))])],1)]),t("ds-filter-drawer",{attrs:{filterDrawerVisible:e.addFilteringVisible,modal:!1},on:{"update:filterDrawerVisible":function(t){e.addFilteringVisible=t},"update:filter-drawer-visible":function(t){e.addFilteringVisible=t},resetFilterForm:e.resetArticleFilterForm,submitFilterForm:e.submitArticleFilterForm}},[t("el-form",{ref:"advancedFiltering",attrs:{model:e.advancedFiltering,"label-width":"80px"}},[t("el-form-item",{attrs:{label:e.$t("h.price"),prop:"minPrice"}},[t("div",{staticClass:"inp-box"},[t("el-input",{staticClass:"input-small",attrs:{placeholder:e.$t("h.formTips72"),type:"number",min:"0"},on:{change:e.changeMinPrice},model:{value:e.advancedFiltering.minPrice,callback:function(t){e.$set(e.advancedFiltering,"minPrice",t)},expression:"advancedFiltering.minPrice"}}),e._v("    -     "),t("el-input",{staticClass:"input-small",attrs:{placeholder:e.$t("h.formTips73"),type:"number"},on:{change:e.changeMaxPrice},model:{value:e.advancedFiltering.maxPrice,callback:function(t){e.$set(e.advancedFiltering,"maxPrice",t)},expression:"advancedFiltering.maxPrice"}})],1)]),t("el-form-item",{attrs:{label:e.$t("h.formTips70"),prop:"minUpperSize"}},[t("div",{staticClass:"inp-box"},[t("el-input",{staticClass:"input-small",attrs:{placeholder:e.$t("h.formTips72"),type:"number",min:"0"},on:{change:e.changeMinUpperSize},model:{value:e.advancedFiltering.minUpperSize,callback:function(t){e.$set(e.advancedFiltering,"minUpperSize",t)},expression:"advancedFiltering.minUpperSize"}}),e._v("    -     "),t("el-input",{staticClass:"input-small",attrs:{placeholder:e.$t("h.formTips73"),type:"number"},on:{change:e.changeMaxUpperSize},model:{value:e.advancedFiltering.maxUpperSize,callback:function(t){e.$set(e.advancedFiltering,"maxUpperSize",t)},expression:"advancedFiltering.maxUpperSize"}})],1)]),t("el-form-item",{attrs:{label:e.$t("h.formTips71"),prop:"minLowerSize"}},[t("div",{staticClass:"inp-box"},[t("el-input",{staticClass:"input-small",attrs:{placeholder:e.$t("h.formTips72"),type:"number",min:"0"},on:{change:e.changeMinLowerSize},model:{value:e.advancedFiltering.minLowerSize,callback:function(t){e.$set(e.advancedFiltering,"minLowerSize",t)},expression:"advancedFiltering.minLowerSize"}}),e._v("    -     "),t("el-input",{staticClass:"input-small",attrs:{placeholder:e.$t("h.formTips73"),type:"number"},on:{change:e.changeMaxLowerSize},model:{value:e.advancedFiltering.maxLowerSize,callback:function(t){e.$set(e.advancedFiltering,"maxLowerSize",t)},expression:"advancedFiltering.maxLowerSize"}})],1)]),t("el-form-item",{attrs:{label:e.$t("h.fuzzyQuery"),prop:"andLike"}},[t("el-input",{model:{value:e.advancedFiltering.andLike,callback:function(t){e.$set(e.advancedFiltering,"andLike",t)},expression:"advancedFiltering.andLike"}})],1)],1)],1)],1),t("div",{staticClass:"body"},[t("ds-table",{ref:"assetTableDataDisplay",attrs:{loading:e.tableLoading,tableData:e.assetTableDataDisplay,tableConfig:e.assetTableConfig,columns:e.columns,rowKey:e=>e.warehousingId,onlyKey:"warehousingId"},on:{handleSelectionChange:e.bodySelete},scopedSlots:e._u([{key:"roleRule",fn:function({scope:a}){return[t("p",{staticClass:"inventory-name",on:{click:function(t){return e.lookDetails(a.row)}}},[e._v(" "+e._s(a.row.roleRule)+" ")])]}}])}),t("div",{staticClass:"pagination"},[t("ds-pagination",{attrs:{small:"",total:e.total,page:e.paginationForm.currentPage,limit:e.paginationForm.pageSize},on:{"update:page":function(t){return e.$set(e.paginationForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.paginationForm,"pageSize",t)},pagination:e.changeSizePage}})],1)],1),t("ds-filter-drawer",{attrs:{filterDrawerVisible:e.bodyFilteringVisible},on:{"update:filterDrawerVisible":function(t){e.bodyFilteringVisible=t},"update:filter-drawer-visible":function(t){e.bodyFilteringVisible=t},resetFilterForm:e.resetBodyFilterForm,submitFilterForm:e.submitBodyFilterForm}},[t("el-form",{ref:"bodyFiltering",attrs:{model:e.bodyFiltering,"label-width":"80px"}},[t("el-form-item",{attrs:{label:e.$t("h.state"),prop:"status"}},[t("el-select",{attrs:{placeholder:e.$t("h.tips4")+e.$t("h.state")},model:{value:e.bodyFiltering.status,callback:function(t){e.$set(e.bodyFiltering,"status",t)},expression:"bodyFiltering.status"}},[t("el-option",{attrs:{label:e.$t("h.approved"),value:"0"}}),t("el-option",{attrs:{label:e.$t("h.pending"),value:"1"}})],1)],1),t("el-form-item",{attrs:{label:e.$t("h.creator"),prop:"staffId"}},[t("el-select",{attrs:{multiple:"",placeholder:e.$t("h.tips4")},model:{value:e.bodyFiltering.staffId,callback:function(t){e.$set(e.bodyFiltering,"staffId",t)},expression:"bodyFiltering.staffId"}},e._l(e.employeeData,(function(e){return t("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("h.creationTime"),prop:"createDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange",placeholder:e.$t("h.tips4")+e.$t("h.creationTime"),clearable:"","start-placeholder":e.$t("h.startDate"),"end-placeholder":e.$t("h.endDate"),"value-format":"yyyy-MM-dd"},model:{value:e.bodyFiltering.createDate,callback:function(t){e.$set(e.bodyFiltering,"createDate",t)},expression:"bodyFiltering.createDate"}})],1),t("el-form-item",{attrs:{label:e.$t("h.fuzzyQuery"),prop:"andLike"}},[t("el-input",{model:{value:e.bodyFiltering.andLike,callback:function(t){e.$set(e.bodyFiltering,"andLike",t)},expression:"bodyFiltering.andLike"}})],1)],1)],1),t("bill-print-template",{ref:"vptRef",attrs:{title:`${e.$t("h.formTips75")}`,selectId:e.warehousingTemplateId,voucherPrintTempList:e.billPrintTemplate}}),t("kc-bill-print-dialog",{ref:"vpdRef",attrs:{locationName:"warehousingTemplateId",userInfo:e.userInfo,voucherData:e.assetTableSelectData,voucherPrintTemplate:e.billPrintTemplate}})],1)],1)},s=[],r=(a(57658),a(30541),a(19698)),l=a(92003),n=a(89782),o=a(66403),h=a(60983),c=a(42041),d=a(5791),u=a(93082),m=a(17817),p=a(93390),g=a(17386),f=a(79992),D=a(83151),b=a(76080),v=a(20629),F={components:{DsQueryForm:r.Z,DsQueryFormLeftPanel:l.Z,DsQueryFormRightPanel:n.Z,DsSearchBtn:o.Z,DsTable:h.Z,NewBillsDialog:c.Z,DsFilterDrawer:d.Z,DsPagination:u.Z,DsFilterTag:m.Z,BillPrintTemplate:p.Z,KcBillPrintDialog:g.Z},data(){return{highlightCurrent:!0,receivingDepartmentData:[],assetAttrData:[],warehousingTemplateId:"",billPrintTemplate:[],userId:"",token:"",staffId:"",staffData:[],warning:!1,warningTitle:"",employeeData:[],isWarehousing:!0,look:!1,andLike:"",tableLoading:!1,assetTableData:[],columns:D.vg,assetTableConfig:{selection:!0},paginationForm:{currentPage:1,pageSize:20},assetTableSelectData:[],houseNameData:[],bodyFilteringVisible:!1,bodyFiltering:{status:"",staffId:"",createDate:"",andLike:""},highFilterTags:[],warehouseData:[],newBillsDialogVisible:!1,pushWarehouseData:{roleRule:this.$t("h.warehouseEntryNumber"),houseId:[],useDate:(0,f.X$)(),vendName:"",staffName:JSON.parse(sessionStorage.getItem("vuex")).userInfo.staffName,createDate:(0,f.X$)(),remark:""},pushWarehouseRules:{houseId:[{required:!0,message:this.$t("h.tips4")+this.$t("h.formTips54"),trigger:"change"}]},sourceListData:[],newArticleDetailsColumns:D.a5,articleDetailsData:[],selectArticleDetailsData:[],articleDialogVisible:!1,subMenuList:[],subMenuListProps:{children:"children",label:"name"},newArticleColumns:D.QW,articleData:[],articleAndLike:"",selectArticleData:[],articlePaginationForm:{currentPage:1,pageSize:20},difference:"all",recordSortingData:[],addFilteringVisible:!1,advancedFiltering:{minPrice:"",maxPrice:"",minUpperSize:"",maxUpperSize:"",minLowerSize:"",maxLowerSize:"",andLike:""},articleHighFilterTags:[],waitFilesData:!1}},computed:{...(0,v.rn)(["userInfo"]),articleTotal(){return this.articleData.length},total(){return this.assetTableData.length},articleDataDisplay(){let e=0,t=this.articlePaginationForm.pageSize-1,a=[];if(1==this.articlePaginationForm.currentPage)for(let i=e;i<t;i++)this.articleData[i]&&a.push(this.articleData[i]);else for(let i=t*(this.articlePaginationForm.currentPage-1);i<t*this.articlePaginationForm.currentPage;i++)this.articleData[i]&&a.push(this.articleData[i]);return a},assetTableDataDisplay(){let e=[],t=0,a=this.paginationForm.pageSize-1;if(1==this.paginationForm.currentPage)for(let i=t;i<a;i++)this.assetTableData[i]&&e.push(this.assetTableData[i]);else for(let i=a*(this.paginationForm.currentPage-1);i<a*this.paginationForm.currentPage;i++)this.assetTableData[i]&&e.push(this.assetTableData[i]);return e}},methods:{toggleSelection(e){e?e.forEach((e=>{this.$refs.articleData.toggleRowSelection(e)})):this.$refs.articleData.clearSelection()},goPrintBills(){return 0==this.assetTableSelectData.length?this.$message.error(this.$t("h.tips121")):this.assetTableSelectData.length>10?this.$message.error(this.$t("h.tips122")+10+this.$t("h.tips123")):void(this.$refs["vpdRef"].voucherPrintDialogVisible=!0)},openPrintSet(){this.$refs["vptRef"].printTempDialogVisible=!0},getBillPrintTemplate(){(0,b.Ys)({func:"S0034",userId:this.userInfo._id,token:this.userInfo.token,requstData:{type:"KCRK"}}).then((({data:e})=>{if(0!=e.code)return this.$message.error(e.data);this.billPrintTemplate=e.data,this.warehousingTemplateId=localStorage.getItem("warehousingTemplateId"),this.billPrintTemplate.some((e=>e._id==this.warehousingTemplateId))||(this.warehousingTemplateId=this.billPrintTemplate[0]._id,localStorage.setItem("warehousingTemplateId",this.warehousingTemplateId))})).catch((()=>{this.$message.error(this.$t("h.tips119"))}))},articleHandleCloseFilterTag(e){switch(this.waitFilesData=!0,this.difference="individual",e.keyStr){case"price":this.advancedFiltering.maxPrice="",this.advancedFiltering.minPrice="";break;case"upperSize":this.advancedFiltering.maxUpperSize="",this.advancedFiltering.minUpperSize="";break;case"lowerSize":this.advancedFiltering.maxLowerSize="",this.advancedFiltering.minLowerSize="";break;default:this.advancedFiltering.andLike=""}this.articleHighFilterTags.splice(this.articleHighFilterTags.indexOf(e),1);let t={status:"false",price:"",upperSize:"",lowerSize:"",andLike:""};this.articleHighFilterTags.forEach((e=>{for(let a in t)e.keyStr==a&&(t[a]=e.value)}));for(let a in t)""!=t[a]&&","!=t[a]||delete t[a];(0,b.C3)({func:"SU0001",userId:this.userId,token:this.token,requstData:t}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data?(this.articleData=e.data,this.articleData.forEach((e=>{e.image&&(e.image=window.$EXCEL_URL+"image/"+e.image,e.prop=e.image)})),this.recordSortingData=JSON.parse(JSON.stringify(e.data))):this.articleData=[];let t=setTimeout((()=>{this.waitFilesData=!1,t&&clearTimeout(t)}),500);this.markArticle()})).catch((e=>{this.$message.error(e);let t=setTimeout((()=>{this.waitFilesData=!1,t&&clearTimeout(t)}),500)}))},handleCloseFilterTag(e){switch(e.keyStr){case"status":this.bodyFiltering.status="";break;case"staffId":this.bodyFiltering.staffId="";break;case"createDate":this.bodyFiltering.createDate="";break;default:this.bodyFiltering.andLike="";break}this.highFilterTags.splice(this.highFilterTags.indexOf(e),1);let t={andLike:"",status:"",createDate:"",staffId:"",type:"0"};this.highFilterTags.forEach((e=>{for(let a in t)e.keyStr==a&&(t[a]="status"==a||"staffId"==a?e.uploadValue:e.value)}));for(let a in t)""!=t[a]&&","!=t[a]||delete t[a];(0,b.C3)({func:"WA0001",userId:this.userId,token:this.token,requstData:t}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data?(this.assetTableData=e.data,this.assetTableData.forEach((e=>{"0"==e.type?e.typeName=this.$t("h.title222"):e.typeName=this.$t("h.title223"),"0"==e.status?e.statusName=this.$t("h.approved"):e.statusName=this.$t("h.pending"),this.houseNameData.forEach((t=>{e.houseId==t.value&&(e.houseName=t.name)}))}))):this.assetTableData=[]})).catch((e=>{this.$message.error(e)}))},changeMaxLowerSize(e){if(""==this.advancedFiltering.minLowerSize.trim()&&""==e)return;let t=/^[0-9]+$/;if(!t.test(e))return this.advancedFiltering.maxLowerSize=(1*this.advancedFiltering.minLowerSize+1).toString(),this.$message.error(this.$t("h.tips255"));(""==this.advancedFiltering.maxLowerSize.trim()||Number(this.advancedFiltering.maxLowerSize)<=Number(this.advancedFiltering.minLowerSize))&&(this.advancedFiltering.maxLowerSize=(1*this.advancedFiltering.minLowerSize+1).toString())},changeMinLowerSize(e){if(""==this.advancedFiltering.maxLowerSize.trim()&&""==e)return;let t=/^[0-9]+$/;if(!t.test(e))return this.advancedFiltering.minLowerSize="0",this.$message.error(this.$t("h.tips255"));(""==this.advancedFiltering.maxLowerSize.trim()||Number(this.advancedFiltering.maxLowerSize)<Number(e))&&(this.advancedFiltering.maxLowerSize=(1*e+1).toString())},changeMaxUpperSize(e){if(""==this.advancedFiltering.minUpperSize.trim()&&""==e)return;let t=/^[0-9]+$/;if(!t.test(e))return this.advancedFiltering.maxUpperSize=(1*this.advancedFiltering.minUpperSize+1).toString(),this.$message.error(this.$t("h.tips255"));(""==this.advancedFiltering.maxUpperSize.trim()||Number(this.advancedFiltering.maxUpperSize)<=Number(this.advancedFiltering.minUpperSize))&&(this.advancedFiltering.maxUpperSize=(1*this.advancedFiltering.minUpperSize+1).toString())},changeMinUpperSize(e){if(""==this.advancedFiltering.maxUpperSize.trim()&&""==e)return;let t=/^[0-9]+$/;if(!t.test(e))return this.advancedFiltering.minUpperSize="0",this.$message.error(this.$t("h.tips255"));(""==this.advancedFiltering.maxUpperSize.trim()||Number(this.advancedFiltering.maxUpperSize)<Number(e))&&(this.advancedFiltering.maxUpperSize=(1*e+1).toString())},changeMaxPrice(){(""==this.advancedFiltering.maxPrice.trim()||Number(this.advancedFiltering.maxPrice)<=Number(this.advancedFiltering.minPrice))&&(this.advancedFiltering.maxPrice=(1*this.advancedFiltering.minPrice+1).toString())},changeMinPrice(e){(""==this.advancedFiltering.maxPrice.trim()||Number(this.advancedFiltering.maxPrice)<Number(e))&&(this.advancedFiltering.maxPrice=(1*e+1).toString())},changeSizePage(e){this.paginationForm.currentPage=e.page,this.paginationForm.pageSize=e.limit},articleChangeSizePage(e){let t=this.selectArticleData;this.articlePaginationForm.currentPage=e.page,this.articlePaginationForm.pageSize=e.limit;let a=setTimeout((()=>{t&&t.length&&this.$nextTick((()=>{t.forEach((e=>{this.articleData.forEach((t=>{e.substanceId==t.substanceId&&(this.toggleSelection([t]),a&&clearTimeout(a))}))}))}))}),100)},getWarehouseData(){(0,b.C3)({func:"ST0001",userId:this.userId,token:this.token,requstData:{}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);if(e.data){let t=[];e.data.forEach((e=>{e.disabled||"0"!=e.state||t.push({name:e.name,label:e.name,value:e.houseId,state:e.state,subId:e.subId}),this.houseNameData.push({name:e.name,value:e.houseId,state:e.state})})),this.warehouseData=this.tree(t,"-")}})).catch((e=>{this.$message.error(e)}))},getEmployeeData(){(0,b.Ys)({func:"S0005",userId:this.userId,token:this.token,requstData:{_id:""}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data&&(this.employeeData=e.data)})).catch((e=>{this.$message.error(e)}))},tree(e,t){const a=[];return e.forEach((i=>{if(i.subId==t){const t=this.tree(e,i.sortingId);t.length>0&&(i.children=t),a.push(i)}})),a},getClassificationData(){(0,b.C3)({func:"SO0001",userId:this.userId,token:this.token,requstData:{}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data&&(this.subMenuList=e.data,this.subMenuList.forEach((e=>{e.subId||(e.subId="-")})),this.subMenuList=this.tree(this.subMenuList,"-"))})).catch((e=>{this.$message.error(e)}))},async sortingDataSwitching(e){this.highlightCurrent=!0,this.difference="individual",await this.getFilesData(e.sortingId)},getFilesData(e){this.waitFilesData=!0;let t=[],a={status:!1};"showAll"==e?(this.difference="all",this.highlightCurrent=!1):e&&"await"!=e&&(a.sortingId=e),(0,b.C3)({func:"SU0001",userId:this.userId,token:this.token,requstData:a}).then((({data:a})=>{if("-1"==a.code)return this.$message.error(a.data);if(a.data){this.articleData=JSON.parse(JSON.stringify(a.data)),this.articleData.forEach((e=>{e.image&&(e.image=window.$EXCEL_URL+"image/"+e.image,e.prop=e.image)})),"await"==e&&this.$nextTick((()=>{this.articleDetailsData.forEach((e=>{this.articleData.forEach((a=>{e.substanceId==a.substanceId&&(this.toggleSelection([a]),t.push(a))}))}))})),e&&"await"!=e&&(this.recordSortingData=JSON.parse(JSON.stringify(a.data)));let i=setTimeout((()=>{"await"==e&&(this.selectArticleData=t),this.waitFilesData=!1,i&&clearTimeout(i)}),500)}else this.articleData=[],this.waitFilesData=!1;this.markArticle()})).catch((e=>{this.$message.error(e);let t=setTimeout((()=>{this.waitFilesData=!1,t&&clearTimeout(t)}),500)}))},articleSelete(e){if("all"!=this.difference||this.waitFilesData){if("individual"==this.difference&&!this.waitFilesData){let t=[];this.selectArticleData.forEach(((e,a)=>{this.recordSortingData.every((t=>e.substanceId==t.substanceId))&&t.unshift(a)})),t.forEach((e=>{this.selectArticleData.splice(e,1)})),this.selectArticleData=this.selectArticleData.concat(JSON.parse(JSON.stringify(e))),this.selectArticleData.forEach((e=>{e.amount||(e.amount=1),e.price||(e.price=0),e.money||(e.money=e.amount*e.price)}))}}else this.selectArticleData=JSON.parse(JSON.stringify(e)),this.selectArticleData.forEach((e=>{e.amount||(e.amount=1),e.price||(e.price=0),e.money||(e.money=e.amount*e.price)}))},determineItemSelection(){this.articleDetailsData=JSON.parse(JSON.stringify(this.selectArticleData)),this.outArticleDialog(),this.articleHighFilterTags=[]},articleDetailsSelete(e){this.selectArticleDetailsData=e},markArticle(){this.articleDetailsData&&this.articleDetailsData.length&&this.articleDetailsData.forEach((e=>{this.articleData.forEach((t=>{e.substanceId==t.substanceId&&(t.amount=e.amount,t.price=e.price,t.money=e.money)}))}))},deleteArticleDetailsSelete(){if(!this.selectArticleDetailsData||!this.selectArticleDetailsData.length)return this.$message.error(this.$t("h.tips256"));for(let e=this.articleDetailsData.length-1;e>=0;e--)this.selectArticleDetailsData.forEach((t=>{this.articleDetailsData[e]&&this.articleDetailsData[e].substanceId==t.substanceId&&(this.articleDetailsData.splice(e,1),0==e&&this.$message.success(this.$t("h.tips128")))}));this.selectArticleDetailsData=[]},articleDialogVisibleClose(){this.articleDialogVisible=!1,this.warning=!1,this.warningTitle="",this.articleAndLike="",this.subMenuList=[],this.articleData=[],this.difference="all"},outArticleDialog(){if("individual"==this.difference){this.waitFilesData=!0;let e=setTimeout((()=>{this.waitFilesData=!1,e&&clearTimeout(e)}),500)}this.articleDialogVisible=!1,this.warning=!1,this.warningTitle="",this.articleAndLike="",this.subMenuList=[],this.articleData=[],this.difference="all"},articleSearch(){this.waitFilesData=!0,this.difference="individual",(0,b.C3)({func:"SU0001",userId:this.userId,token:this.token,requstData:{andLike:this.articleAndLike,status:!1}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data?(this.articleData=JSON.parse(JSON.stringify(e.data)),this.articleData.forEach((e=>{e.image&&(e.image=window.$EXCEL_URL+"image/"+e.image,e.prop=e.image)})),this.recordSortingData=JSON.parse(JSON.stringify(e.data))):this.articleData=[];let t=setTimeout((()=>{this.waitFilesData=!1,t&&clearTimeout(t)}),500);this.markArticle()})).catch((e=>{this.$message.error(e)}))},changeMoney(e,t){this.articleDetailsData[e].money=t.amount*t.price},warehousing(){this.$refs["pushWarehouseDataRef"].validate((e=>{if(!e)return!1;if(!this.articleDetailsData||!this.articleDetailsData.length)return this.$message.error(this.$t("h.tips256"));let t=!1,a=[];for(let s=0;s<this.articleDetailsData.length;s++)a.push({substanceId:this.articleDetailsData[s].substanceId,amount:this.articleDetailsData[s].amount,money:this.articleDetailsData[s].money,price:this.articleDetailsData[s].price}),this.articleDetailsData[s].money<1&&(t=!0);if(t)return this.$message.error(this.$t("h.tips258"));let i=this.staffData.find((e=>e._id==this.userId)).deptId;this.isWarehousing?(0,b.C3)({func:"IN0002",userId:this.userId,token:this.token,requstData:{createDate:this.pushWarehouseData.createDate,useDate:this.pushWarehouseData.useDate,staffId:this.staffId,deptId:i,type:"0",vendName:this.pushWarehouseData.vendName,houseId:this.pushWarehouseData.houseId.length>1?this.pushWarehouseData.houseId[this.pushWarehouseData.houseId.length-1]:this.pushWarehouseData.houseId.join(),remark:this.pushWarehouseData.remark,details:a}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);this.$message.success(e.data),this.newBillsDialogVisible=!1,this.isWarehousing=!0,this.$refs["pushWarehouseDataRef"].resetFields(),this.articleDetailsData=[],this.selectArticleDetailsData=[],this.getWarehousingDocuments()})).catch((e=>{this.$message.error(e)})):(0,b.C3)({func:"IN0003",userId:this.userId,token:this.token,requstData:{warehousingId:this.pushWarehouseData.warehousingId,createDate:this.pushWarehouseData.createDate,staffId:this.staffId,deptId:i,vendName:this.pushWarehouseData.vendName,houseId:this.pushWarehouseData.houseId.length>1?this.pushWarehouseData.houseId[this.pushWarehouseData.houseId.length-1]:this.pushWarehouseData.houseId.join(),remark:this.pushWarehouseData.remark,details:a}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);this.$message.success(e.data),this.newBillsDialogVisible=!1,this.isWarehousing=!0,this.$refs["pushWarehouseDataRef"].resetFields(),this.articleDetailsData=[],this.selectArticleDetailsData=[],this.getWarehousingDocuments()})).catch((e=>{this.$message.error(e)}))}))},bulkBillsDialogClose(){this.$refs["pushWarehouseDataRef"].resetFields(),this.articleDetailsData=[],this.selectArticleDetailsData=[],this.isWarehousing=!0,this.look=!1,this.pushWarehouseData={roleRule:this.$t("h.warehouseEntryNumber"),houseId:[],useDate:(0,f.X$)(),vendName:"",staffName:JSON.parse(sessionStorage.getItem("vuex")).userInfo.staffName,createDate:(0,f.X$)(),remark:""}},getWarehousingDocuments(){(0,b.C3)({func:"WA0001",userId:this.userId,token:this.token,requstData:{type:"0"}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);if(e.data){this.assetTableData=e.data;let t=setTimeout((()=>{this.assetTableData.forEach((e=>{this.houseNameData.forEach((t=>{e.houseId==t.value&&(e.houseName=t.name)})),"0"==e.type?e.typeName=this.$t("h.title222"):e.typeName=this.$t("h.title223"),"0"==e.status?e.statusName=this.$t("h.approved"):e.statusName=this.$t("h.pending")})),t&&clearTimeout(t)}),100)}else this.assetTableData=[]})).catch((e=>{this.$message.error(e)}))},resetArticleFilterForm(){this.waitFilesData=!0,this.difference="individual",this.articleHighFilterTags=[],this.$refs["advancedFiltering"].resetFields(),this.advancedFiltering.maxPrice="",this.advancedFiltering.maxUpperSize="",this.advancedFiltering.maxLowerSize="",(0,b.C3)({func:"SU0001",userId:this.userId,token:this.token,requstData:{status:!1}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data?(this.articleData=e.data,this.articleData.forEach((e=>{e.image&&(e.image=window.$EXCEL_URL+"image/"+e.image,e.prop=e.image)})),this.recordSortingData=JSON.parse(JSON.stringify(e.data))):this.articleData=[];let t=setTimeout((()=>{this.waitFilesData=!1,t&&clearTimeout(t)}),500);this.markArticle(),this.addFilteringVisible=!1})).catch((e=>{this.$message.error(e)}))},submitArticleFilterForm(){if(this.waitFilesData=!0,this.difference="individual",""!=this.advancedFiltering.minPrice.trim()&&""==this.advancedFiltering.maxPrice.trim()||""==this.advancedFiltering.minPrice.trim()&&""!=this.advancedFiltering.maxPrice.trim())return this.$message.error(this.$t("h.tips259"));if(""!=this.advancedFiltering.minUpperSize.trim()&&""==this.advancedFiltering.maxUpperSize.trim()||""==this.advancedFiltering.minUpperSize.trim()&&""!=this.advancedFiltering.maxUpperSize.trim())return this.$message.error(this.$t("h.tips259"));if(""!=this.advancedFiltering.minLowerSize.trim()&&""==this.advancedFiltering.maxLowerSize.trim()||""==this.advancedFiltering.minLowerSize.trim()&&""!=this.advancedFiltering.maxLowerSize.trim())return this.$message.error(this.$t("h.tips259"));let e={status:"false",price:this.advancedFiltering.minPrice+","+this.advancedFiltering.maxPrice,upperSize:this.advancedFiltering.minUpperSize+","+this.advancedFiltering.maxUpperSize,lowerSize:this.advancedFiltering.minLowerSize+","+this.advancedFiltering.maxLowerSize,andLike:this.advancedFiltering.andLike};for(let t in e)""!=e[t]&&","!=e[t]||delete e[t];(0,b.C3)({func:"SU0001",userId:this.userId,token:this.token,requstData:e}).then((({data:t})=>{if(this.articleHighFilterTags=[],"-1"==t.code)return this.$message.error(t.data);t.data?(this.articleData=JSON.parse(JSON.stringify(t.data)),this.articleData.forEach((e=>{e.image&&(e.image=window.$EXCEL_URL+"image/"+e.image,e.prop=e.image)})),this.recordSortingData=JSON.parse(JSON.stringify(t.data))):this.articleData=[];let a=setTimeout((()=>{this.waitFilesData=!1,a&&clearTimeout(a)}),500);this.markArticle();for(let i in e)"price"==i?this.articleHighFilterTags.push({name:this.$t("h.price"),value:e[i],keyStr:i}):"upperSize"==i?this.articleHighFilterTags.push({name:this.$t("h.formTips70"),value:e[i],keyStr:i}):"lowerSize"==i?this.articleHighFilterTags.push({name:this.$t("h.formTips71"),value:e[i],keyStr:i}):"andLike"==i&&this.articleHighFilterTags.push({name:this.$t("h.fuzzyQuery"),value:e[i],keyStr:i});this.addFilteringVisible=!1})).catch((e=>{this.$message.error(e)}))},resetBodyFilterForm(){this.$refs["bodyFiltering"].resetFields(),this.highFilterTags=[],(0,b.C3)({func:"WA0001",userId:this.userId,token:this.token,requstData:{type:"0"}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data?(this.assetTableData=e.data,this.assetTableData.forEach((e=>{"0"==e.type?e.typeName=this.$t("h.title222"):e.typeName=this.$t("h.title223"),"0"==e.status?e.statusName=this.$t("h.approved"):e.statusName=this.$t("h.pending"),this.houseNameData.forEach((t=>{e.houseId==t.value&&(e.houseName=t.name)}))}))):this.assetTableData=[],this.$refs["bodyFiltering"].resetFields(),this.bodyFilteringVisible=!1})).catch((e=>{this.$message.error(e)}))},submitBodyFilterForm(){let e={andLike:this.bodyFiltering.andLike,status:this.bodyFiltering.status,createDate:this.bodyFiltering.createDate?this.bodyFiltering.createDate.join():this.bodyFiltering.createDate,staffId:this.bodyFiltering.staffId?this.bodyFiltering.staffId.join():this.bodyFiltering.staffId,type:"0"};for(let t in e)""!=e[t]&&","!=e[t]||delete e[t];(0,b.C3)({func:"WA0001",userId:this.userId,token:this.token,requstData:e}).then((({data:t})=>{if(this.highFilterTags=[],"-1"==t.code)return this.$message.error(t.data);t.data?(this.assetTableData=t.data,this.assetTableData.forEach((e=>{"0"==e.type?e.typeName=this.$t("h.title222"):e.typeName=this.$t("h.title223"),"0"==e.status?e.statusName=this.$t("h.approved"):e.statusName=this.$t("h.pending"),this.houseNameData.forEach((t=>{e.houseId==t.value&&(e.houseName=t.name)}))}))):this.assetTableData=[];for(let a in e)if("status"==a){let t="";t="0"==e[a]?this.$t("h.approved"):this.$t("h.pending"),this.highFilterTags.push({name:this.$t("h.state"),value:t,uploadValue:e[a],keyStr:a})}else if("staffId"==a){let t="";this.employeeData.forEach((i=>{i._id==e[a]&&(t=i.name)})),this.highFilterTags.push({name:this.$t("h.creator"),value:t,uploadValue:e[a],keyStr:a})}else"createDate"==a?this.highFilterTags.push({name:this.$t("h.creationTime"),value:e[a],keyStr:a}):"andLike"==a&&this.highFilterTags.push({name:this.$t("h.fuzzyQuery"),value:e[a],keyStr:a});this.bodyFilteringVisible=!1})).catch((e=>{this.$message.error(e)}))},bodySearch(){(0,b.C3)({func:"WA0001",userId:this.userId,token:this.token,requstData:{andLike:this.andLike,type:"0"}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);e.data?(this.assetTableData=e.data,this.assetTableData.forEach((e=>{"0"==e.type?e.typeName=this.$t("h.title222"):e.typeName=this.$t("h.title223"),"0"==e.status?e.statusName=this.$t("h.approved"):e.statusName=this.$t("h.pending"),this.houseNameData.forEach((t=>{e.houseId==t.value&&(e.houseName=t.name)}))}))):this.assetTableData=[]})).catch((e=>{this.$message.error(e)}))},bodySelete(e){this.assetTableSelectData=e,this.assetTableSelectData.forEach((e=>{e.list[0].amount=e.details[0].amount,e.list[0].money=e.details[0].money}))},editingOperations(e){"modify"==e?this.modifyReceiptDocuments():"delete"==e&&this.deleteReceiptDocuments()},modifyReceiptDocuments(){if(this.assetTableSelectData.length>1)return this.$message.error(this.$t("h.tips110"));this.newBillsDialogVisible=!0,this.isWarehousing=!1,this.pushWarehouseData={roleRule:this.assetTableSelectData[0].roleRule,houseId:this.assetTableSelectData[0].houseId,useDate:this.assetTableSelectData[0].useDate,vendName:this.assetTableSelectData[0].vendName,staffName:this.assetTableSelectData[0].staffId,createDate:this.assetTableSelectData[0].createDate,remark:this.assetTableSelectData[0].remark,warehousingId:this.assetTableSelectData[0].warehousingId},this.articleDetailsData=this.assetTableSelectData[0].list,this.assetTableSelectData[0].details.forEach(((e,t)=>{this.articleDetailsData[t].amount=e.amount,this.articleDetailsData[t].money=e.money,this.articleDetailsData[t].price=e.price,this.articleDetailsData[t].substanceId=e.substanceId}))},deleteReceiptDocuments(){let e=[];this.assetTableSelectData.forEach((t=>e.push(t.warehousingId)));let t=e.join();this.$confirm(this.$t("h.tips260"),this.$t("h.title18"),{confirmButtonText:this.$t("h.confirmBtn"),cancelButtonText:this.$t("h.cancelBtn"),type:"warning"}).then((()=>{(0,b.C3)({func:"WA0004",userId:this.userId,token:this.token,requstData:{warehousingId:t}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);this.$message({type:"success",message:this.$t("h.tips128")}),this.getWarehousingDocuments()})).catch((e=>{this.$message.error(e)}))})).catch((()=>{this.$message({type:"info",message:this.$t("h.tips98")})}))},lookDetails(e){this.newBillsDialogVisible=!0,this.look=!0,this.pushWarehouseData={roleRule:e.roleRule,houseId:e.houseId,useDate:e.useDate,vendName:e.vendName,staffName:e.staffId,createDate:e.createDate,remark:e.remark,warehousingId:e.warehousingId},e.list?this.articleDetailsData=e.list:this.articleDetailsData=[],e.details&&e.details.forEach(((e,t)=>{this.articleDetailsData[t].amount=e.amount,this.articleDetailsData[t].money=e.money,this.articleDetailsData[t].price=e.price,this.articleDetailsData[t].substanceId=e.substanceId})),this.articleDetailsData.forEach((e=>{e.image&&"h"!=e.image[0]&&(e.image=window.$EXCEL_URL+"image/"+e.image,e.prop=e.image)}))},exportFile(){(0,b.C3)({func:"WA0001",userId:this.userId,token:this.token,requstData:{type:"0",pull:1}}).then((({data:e})=>{if("-1"==e.code)return this.$message.error(e.data);(0,f.M)(window.$EXCEL_URL+e.data),this.$message.success(this.$t("h.exportSuccessful"))})).catch((e=>{this.$message.error(e)}))}},watch:{articleDialogVisible:function(e){e&&(this.getClassificationData(),this.articleDetailsData&&this.articleDetailsData.length?this.getFilesData("await"):this.getFilesData())},"pushWarehouseData.houseId":function(e){for(let t=0;t<this.houseNameData.length;t++){if(this.houseNameData[t].value==e&&"-1"==this.houseNameData[t].state)return this.warning=!0,void(this.warningTitle=this.houseNameData[t].name);this.houseNameData.length-1==t&&(this.warning=!1,this.warningTitle="")}},articleDataDisplay:function(){this.selectArticleData&&this.selectArticleData.length&&this.$nextTick((()=>{this.selectArticleData.forEach((e=>{this.articleData.forEach((t=>{e.substanceId==t.substanceId&&this.toggleSelection([t])}))}))}))}},created(){window.localStorage.getItem("warehousingTemplateId")||window.localStorage.setItem("warehousingTemplateId",42),this.userId=JSON.parse(sessionStorage.getItem("vuex")).userInfo._id,this.token=JSON.parse(sessionStorage.getItem("vuex")).userInfo.token,this.staffId=JSON.parse(sessionStorage.getItem("vuex")).userInfo.staffId,this.getWarehousingDocuments(),this.getEmployeeData(),this.warehousingTemplateId=localStorage.getItem("warehousingTemplateId"),this.getBillPrintTemplate()}},w=F,$=a(1001),S=(0,$.Z)(w,i,s,!1,null,"22788ce6",null),y=S.exports}}]);