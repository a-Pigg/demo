"use strict";(self["webpackChunk_4010_assetweb"]=self["webpackChunk_4010_assetweb"]||[]).push([[2439],{42041:function(e,t,a){a.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{top:"0","custom-class":"dialog",fullscreen:"",visible:e.dialogVisible,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.dialogVisibleOpened,close:e.dialogVisibleClose,closed:e.dialogVisibleClosed}},[t("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"left"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left",circle:""},on:{click:function(t){e.dialogVisible=!1}}}),t("span",{staticClass:"title"},[e._v(e._s(e.title))])],1),t("div",{staticClass:"right"},[t("el-button",{attrs:{size:"small"},on:{click:e.cancalFrom}},[e._v(e._s(e.$t("h.cancelBtn")))]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sbumitForm}},[e._v(e._s(e.$t("h.confirmBtn")))])],1)]),t("div",{ref:"dialogbodyRef",staticClass:"dialog-body"},[t("div",{staticClass:"content",style:"width:"+e.contentWidth},[t("div",{staticClass:"form-label"},[e._t("form")],2),t("div",{staticClass:"table-label"},[t("div",{staticClass:"table-label-head"},[e._t("btns")],2),t("div",{staticClass:"table-label-content"},[e._t("table")],2)])])])])},s=[],l=a(63042),n={data(){return{}},props:{title:{type:String,default:l.a.t("h.title12")},newBillsDialogVisible:{type:Boolean,default:!1},contentWidth:{type:String,default:"950px"}},computed:{dialogVisible:{get(){return this.newBillsDialogVisible},set(e){this.$emit("update:newBillsDialogVisible",e)}}},methods:{cancalFrom(){this.dialogVisible=!1},sbumitForm(){this.$emit("sbumitForm")},dialogVisibleClose(){this.$emit("close"),this.$refs.dialogbodyRef.scrollTop=0},dialogVisibleClosed(){this.$emit("closed")},dialogVisibleOpened(){this.$emit("opened")}}},o=n,r=a(1001),d=(0,r.Z)(o,i,s,!1,null,"130c4832",null),c=d.exports},93082:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-pagination"},[t("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},s=[],l={name:"DsPagination",data(){return{}},props:{total:{required:!0,type:Number},pageSizes:{type:Array,default(){return[20,50,100]}},page:{type:Number,default:1},limit:{type:Number,default:20},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0}},computed:{currentPage:{get(){return this.page},set(e){this.$emit("update:page",e)}},pageSize:{get(){return this.limit},set(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange(e){this.$emit("pagination",{page:this.currentPage,limit:e})},handleCurrentChange(e){this.$emit("pagination",{page:e,limit:this.pageSize})}}},n=l,o=a(1001),r=(0,o.Z)(n,i,s,!1,null,"2377c114",null),d=r.exports},92003:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"left-panel"},[e._t("default")],2)},s=[],l={name:"DsQueryFormLeftPanel"},n=l,o=a(1001),r=(0,o.Z)(n,i,s,!1,null,"71d76034",null),d=r.exports},89782:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"right-panel"},[e._t("default")],2)},s=[],l={name:"DsQueryFormRightPanel"},n=l,o=a(1001),r=(0,o.Z)(n,i,s,!1,null,"c6443ba6",null),d=r.exports},19698:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-query-form"},[e._t("default")],2)},s=[],l={name:"DsQueryForm"},n=l,o=a(1001),r=(0,o.Z)(n,i,s,!1,null,"6c8bfb78",null),d=r.exports},66403:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-search"},[t("el-input",{attrs:{size:"small",placeholder:e.$t("h.keyword"),"prefix-icon":"el-icon-search"},on:{input:e.onInput},model:{value:e.value,callback:function(t){e.value="string"===typeof t?t.trim():t},expression:"value"}},[t("el-button",{attrs:{slot:"suffix",type:"text",size:"small"},on:{click:e.search},slot:"suffix"},[e._v(e._s(e.$t("h.Search")))])],1)],1)},s=[],l={name:"DsSearchBtn",data(){return{}},props:{searchValue:{type:String}},computed:{value:{get(){return this.searchValue},set(e){this.$emit("update:searchValue",e)}}},methods:{search(){this.$emit("search")},onInput(e){""==e&&this.search()}}},n=l,o=a(1001),r=(0,o.Z)(n,i,s,!1,null,"5bd7b965",null),d=r.exports},88938:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"record"},[t("el-card",{staticClass:"record-card"},[t("div",{staticClass:"record-card-header",attrs:{slot:"header"},slot:"header"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.newBillsDialogVisible=!0}}},[e._v(e._s(e.$t("h.newBtn")))]),t("el-dropdown",{attrs:{trigger:"click"}},[t("el-button",{attrs:{size:"small"}},[e._v(" "+e._s(e.$t("h.editBtn"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[e._v(e._s(e.$t("h.changeBtn")))]),t("el-dropdown-item",[e._v(e._s(e.$t("h.delBtn")))])],1)],1),t("el-dropdown",{attrs:{trigger:"click"}},[t("el-button",{attrs:{size:"small"}},[e._v(" "+e._s(e.$t("h.formTips5"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[e._v(e._s(e.$t("h.printDoucmentBtn")))]),t("el-dropdown-item",[e._v(e._s(e.$t("h.templateSettings")))])],1)],1)],1),t("ds-query-form-right-panel",[t("ds-search-btn")],1)],1)],1),t("div",{staticClass:"record-card-content"},[t("div",{staticClass:"record-filter"},[t("el-button",{staticClass:"advanced-filter-btn",attrs:{type:"text",size:"small"}},[e._v(e._s(e.$t("h.advancedBtn")))])],1),t("div",{staticClass:"record-table"},[t("ds-table",{attrs:{columns:e.paymentRecordBillsColumns,tableConfig:e.paymentRecordBillsColfing,tableData:e.paymentRecordBills}})],1),t("div",{staticClass:"record-pagination"},[t("ds-pagination",{attrs:{small:"",total:e.total,page:e.paginationForm.currentPage,limit:e.paginationForm.pageSize},on:{"update:page":function(t){return e.$set(e.paginationForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.paginationForm,"pageSize",t)},pagination:e.getPaymentRecordBills}})],1)])]),t("new-bills-dialog",{staticClass:"new-bill-dialog",attrs:{newBillsDialogVisible:e.newBillsDialogVisible},on:{"update:newBillsDialogVisible":function(t){e.newBillsDialogVisible=t},"update:new-bills-dialog-visible":function(t){e.newBillsDialogVisible=t},opened:e.newBillsDialogOpened,close:e.newBillsDialogClose,sbumitForm:e.sbumitPaymentRecordForm}},[t("template",{slot:"form"},[t("el-form",{ref:"paymentRecordFormRef",attrs:{"label-width":"110px",model:e.paymentRecordForm,rules:e.paymentRecordRules}},[t("el-form-item",{attrs:{label:e.$t("h.paymentDate"),prop:"paidDate"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:e.$t("h.tips4")+e.$t("h.paymentDate")},model:{value:e.paymentRecordForm.paidDate,callback:function(t){e.$set(e.paymentRecordForm,"paidDate",t)},expression:"paymentRecordForm.paidDate"}})],1)],1)],1),t("template",{slot:"btns"},[t("div",[t("span",{staticClass:"title"},[e._v(e._s(e.$t("h.title151"))+" - "+e._s(e.$t("h.title152")))])]),t("div",{staticClass:"btns"},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){e.paymentOrderDialogVisible=!0}}},[e._v(e._s(e.$t("h.addBtn")))]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.deletePaymentRecordGoods}},[e._v(e._s(e.$t("h.delBtn")))])],1)]),t("template",{slot:"table"},[t("div",{staticClass:"bill-table"},[t("ds-table",{ref:"paymentRecordTableRef",attrs:{columns:e.paymentRecordGoodsColumns,tableConfig:e.paymentRecordBillsColfing,tableData:e.paymentRecordGoods},on:{handleSelectionChange:e.paymentRecordGoodsSelectionChange}})],1)])],2),t("payment-order-dialog",{attrs:{paymentOrderDialogVisible:e.paymentOrderDialogVisible,updatePaymentSelectState:e.paymentRecordGoods},on:{"update:paymentOrderDialogVisible":function(t){e.paymentOrderDialogVisible=t},"update:payment-order-dialog-visible":function(t){e.paymentOrderDialogVisible=t},save:e.peymentOrderSave}})],1)},s=[],l=(a(57658),function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{top:"0","custom-class":"paymentOrderDialog","show-close":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.dialogVisibleOpened}},[t("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"left"},[t("span",[e._v(e._s(e.$t("h.title150"))+" "+e._s(e.$t("h.paymentRequestOrder")))])]),t("div",{staticClass:"right"},[t("i",{staticClass:"el-icon-close",on:{click:function(t){e.dialogVisible=!1}}})])]),t("div",{staticClass:"dialog-body"},[t("div",{staticClass:"payment-order-filter"},[t("el-button",{staticClass:"advanced-filter-btn",attrs:{type:"text",size:"small"}},[e._v(e._s(e.$t("h.advancedBtn")))])],1),t("div",{staticClass:"payment-order-table"},[t("ds-table",{ref:"paymentOrderTableRef",attrs:{loading:e.loading,columns:e.paymentBillsColumns,tableConfig:e.paymentBillsConfig,tableData:e.paymentBills,rowKey:e=>e.id},on:{handleSelectionChange:e.handleSelectionChange}})],1)]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("ds-pagination",{attrs:{small:"",total:e.total,page:e.paginationForm.currentPage,limit:e.paginationForm.pageSize},on:{"update:page":function(t){return e.$set(e.paginationForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.paginationForm,"pageSize",t)},pagination:e.getPaymentBills}}),t("div",{staticClass:"btns"},[t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("h.cancelBtn")))]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.save}},[e._v(e._s(e.$t("h.confirmBtn")))])],1)],1)])}),n=[],o=a(20629),r=a(83151),d=a(60983),c=a(93082),p=a(76080),u={components:{DsTable:d.Z,DsPagination:c.Z},data(){return{total:0,paginationForm:{currentPage:1,pageSize:20},loading:!1,paymentBillsColumns:r.le,paymentBillsConfig:{selection:!0,reserveSelection:!0},paymentBills:[],selectPaymentBills:[]}},props:{paymentOrderDialogVisible:{type:Boolean,default:!1},updatePaymentSelectState:{type:Array,default:()=>[]}},computed:{...(0,o.rn)(["userInfo"]),dialogVisible:{get(){return this.paymentOrderDialogVisible},set(e){this.$emit("update:paymentOrderDialogVisible",e)}}},methods:{getPaymentBills(){this.loading=!0,(0,p.Ys)({func:"S0064",userId:this.userInfo._id,token:this.userInfo.token,requstData:{page:this.paginationForm.pageSize,index:this.paginationForm.currentPage,status:0}}).then((({data:e})=>{if(this.loading=!1,0!=e.code)return this.$message.error(e.data);this.total=e.data[0],this.paymentBills=e.data[1]})).catch((()=>{this.loading=!1,this.$message.error(this.$t("h.tips18"))}))},dialogVisibleOpened(){this.$refs.paymentOrderTableRef.$refs.dsTableRef.clearSelection(),this.updatePaymentSelectState.forEach((e=>{let t=this.paymentBills.find((t=>t.id==e.id));this.$refs.paymentOrderTableRef.$refs.dsTableRef.toggleRowSelection(t,!0)})),this.getPaymentBills()},handleSelectionChange(e){this.selectPaymentBills=e},save(){this.$emit("save",this.selectPaymentBills)}}},m=u,g=a(1001),h=(0,g.Z)(m,l,n,!1,null,"8574880a",null),f=h.exports,y=a(42041),b=a(66403),v=a(19698),C=a(92003),_=a(89782),R={components:{PaymentOrderDialog:f,NewBillsDialog:y.Z,DsSearchBtn:b.Z,DsTable:d.Z,DsPagination:c.Z,DsQueryForm:v.Z,DsQueryFormLeftPanel:C.Z,DsQueryFormRightPanel:_.Z},data(){return{total:0,paginationForm:{currentPage:1,pageSize:20},tableLoading:!1,paymentRecordBillsColumns:r.OR,paymentRecordBillsColfing:{selection:!0,reserveSelection:!0},paymentRecordBills:[],dialogLoading:{target:".new-bill-dialog",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"},newBillsDialogVisible:!1,paymentRecordForm:{paidDate:""},paymentRecordRules:{},paymentRecordGoodsColumns:r.YL,paymentRecordGoods:[],selectPaymentRecordGoods:[],paymentOrderDialogVisible:!1}},computed:{...(0,o.rn)(["userInfo"])},methods:{getPaymentRecordBills(){this.tableLoading=!0,(0,p.Ys)({func:"S0064",userId:this.userInfo._id,token:this.userInfo.token,requstData:{page:this.paginationForm.pageSize,index:this.paginationForm.currentPage,isPaid:0}}).then((({data:e})=>{if(this.tableLoading=!1,0!=e.code)return this.$message.error(e.data);this.total=e.data[0],this.paymentRecordBills=e.data[1]})).catch((()=>{this.tableLoading=!1,this.$message.error(this.$t("h.tips18"))}))},peymentOrderSave(e){this.paymentRecordGoods=e.map((e=>({id:e.id,roleRule:e.roleRule,totalAmount:e.totalAmount,paidAmount:e.paidAmount}))),this.paymentOrderDialogVisible=!1},paymentRecordGoodsSelectionChange(e){this.selectPaymentRecordGoods=e},deletePaymentRecordGoods(){this.selectPaymentRecordGoods.forEach((e=>{this.paymentRecordGoods.splice(this.paymentRecordGoods.findIndex((t=>t.id==e.id)),1)})),this.$refs.paymentRecordTableRef.$refs.dsTableRef.clearSelection()},newBillsDialogOpened(){this.$refs.paymentRecordFormRef.clearValidate()},newBillsDialogClose(){this.paymentRecordGoods=[],this.selectPaymentRecordGoods=[],this.paymentRecordForm.paidDate=""},sbumitPaymentRecordForm(){this.$refs.paymentRecordFormRef.validate((e=>{if(!e)return!1;if(!this.paymentRecordGoods.length)return this.$notify.error({title:this.$t("h.title27"),message:this.$t("h.tips247")});const t=this.$loading(this.dialogLoading);let a=[];this.paymentRecordGoods.forEach((e=>{a.push(e.id)})),(0,p.Vx)({func:"U0071",token:this.userInfo.token,userId:this.userInfo._id,requstData:{paidDate:this.paymentRecordForm.paidDate,ids:a.join(","),permissonId:26}}).then((({data:e})=>{if(t.close(),0!=e.code)return this.$message.error(e.data);this.$message.success(e.data),this.newBillsDialogVisible=!1,this.paginationForm.currentPage=1,this.getPaymentRecordBills()})).catch((()=>{t.close(),this.$message.error(this.$t("h.tips18"))}))}))}},created(){this.getPaymentRecordBills()}},$=R,B=(0,g.Z)($,i,s,!1,null,"2a50aab6",null),D=B.exports}}]);