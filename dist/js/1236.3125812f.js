"use strict";(self["webpackChunk_4010_assetweb"]=self["webpackChunk_4010_assetweb"]||[]).push([[1236],{42041:function(e,t,s){s.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{top:"0","custom-class":"dialog",fullscreen:"",visible:e.dialogVisible,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.dialogVisibleOpened,close:e.dialogVisibleClose,closed:e.dialogVisibleClosed}},[t("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"left"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left",circle:""},on:{click:function(t){e.dialogVisible=!1}}}),t("span",{staticClass:"title"},[e._v(e._s(e.title))])],1),t("div",{staticClass:"right"},[t("el-button",{attrs:{size:"small"},on:{click:e.cancalFrom}},[e._v(e._s(e.$t("h.cancelBtn")))]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sbumitForm}},[e._v(e._s(e.$t("h.confirmBtn")))])],1)]),t("div",{ref:"dialogbodyRef",staticClass:"dialog-body"},[t("div",{staticClass:"content",style:"width:"+e.contentWidth},[t("div",{staticClass:"form-label"},[e._t("form")],2),t("div",{staticClass:"table-label"},[t("div",{staticClass:"table-label-head"},[e._t("btns")],2),t("div",{staticClass:"table-label-content"},[e._t("table")],2)])])])])},a=[],l=s(63042),n={data(){return{}},props:{title:{type:String,default:l.a.t("h.title12")},newBillsDialogVisible:{type:Boolean,default:!1},contentWidth:{type:String,default:"950px"}},computed:{dialogVisible:{get(){return this.newBillsDialogVisible},set(e){this.$emit("update:newBillsDialogVisible",e)}}},methods:{cancalFrom(){this.dialogVisible=!1},sbumitForm(){this.$emit("sbumitForm")},dialogVisibleClose(){this.$emit("close"),this.$refs.dialogbodyRef.scrollTop=0},dialogVisibleClosed(){this.$emit("closed")},dialogVisibleOpened(){this.$emit("opened")}}},o=n,r=s(1001),c=(0,r.Z)(o,i,a,!1,null,"130c4832",null),d=c.exports},98884:function(e,t,s){s.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{top:"0","custom-class":"dialog","show-close":!1,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.dialogVisibleClosed}},[t("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"left"},[t("span",[e._v(e._s(e.title))])]),t("div",{staticClass:"right"},[t("i",{staticClass:"el-icon-close",on:{click:function(t){e.dialogVisible=!1}}})])]),t("div",{staticClass:"dialog-body"},[t("ds-table",{attrs:{tableData:e.deleteErrorData,columns:e.deleteColumns,tableConfig:e.errorTableConfig}})],1)])},a=[],l=s(60983),n={components:{DsTable:l.Z},data(){return{errorTableConfig:{index:!0}}},props:{deleteDialogVisible:{type:Boolean,default:!1},deleteErrorData:{type:Array,default:()=>[]},deleteColumns:{type:Array},title:{type:String,default:"删除失败详情"}},computed:{dialogVisible:{get(){return this.deleteDialogVisible},set(e){this.$emit("update:deleteDialogVisible",e)}}},methods:{dialogVisibleClosed(){this.$emit("closed")}}},o=n,r=s(1001),c=(0,r.Z)(o,i,a,!1,null,"3e3e8f93",null),d=c.exports},93082:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-pagination"},[t("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},a=[],l={name:"DsPagination",data(){return{}},props:{total:{required:!0,type:Number},pageSizes:{type:Array,default(){return[20,50,100]}},page:{type:Number,default:1},limit:{type:Number,default:20},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0}},computed:{currentPage:{get(){return this.page},set(e){this.$emit("update:page",e)}},pageSize:{get(){return this.limit},set(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange(e){this.$emit("pagination",{page:this.currentPage,limit:e})},handleCurrentChange(e){this.$emit("pagination",{page:e,limit:this.pageSize})}}},n=l,o=s(1001),r=(0,o.Z)(n,i,a,!1,null,"2377c114",null),c=r.exports},92003:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"left-panel"},[e._t("default")],2)},a=[],l={name:"DsQueryFormLeftPanel"},n=l,o=s(1001),r=(0,o.Z)(n,i,a,!1,null,"71d76034",null),c=r.exports},89782:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"right-panel"},[e._t("default")],2)},a=[],l={name:"DsQueryFormRightPanel"},n=l,o=s(1001),r=(0,o.Z)(n,i,a,!1,null,"c6443ba6",null),c=r.exports},19698:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-query-form"},[e._t("default")],2)},a=[],l={name:"DsQueryForm"},n=l,o=s(1001),r=(0,o.Z)(n,i,a,!1,null,"6c8bfb78",null),c=r.exports},42228:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-search"},[t("el-input",{attrs:{size:e.size,placeholder:e.$t("h.keyword"),"prefix-icon":"el-icon-search"},model:{value:e.searchValue,callback:function(t){e.searchValue="string"===typeof t?t.trim():t},expression:"searchValue"}})],1)},a=[],l={name:"DsSearch",props:{value:{type:String},size:{type:String,default:"mini"}},computed:{searchValue:{get(){return this.value},set(e){this.$emit("update:value",e)}}},methods:{}},n=l,o=s(1001),r=(0,o.Z)(n,i,a,!1,null,"3e961102",null),c=r.exports},27314:function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reason"},[t("el-card",{staticClass:"reason-card"},[t("div",{staticClass:"reason-card-header",attrs:{slot:"header"},slot:"header"},[t("ds-query-form",[t("ds-query-form-left-panel",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.reasonBillsDialogVisible=!0}}},[e._v(e._s(e.$t("h.newBtn")))]),t("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.deleteReasons}},[e._v(e._s(e.$t("h.delBtn")))])],1),t("ds-query-form-right-panel",[t("ds-search",{attrs:{size:"small",value:e.andLike},on:{"update:value":function(t){e.andLike=t}}})],1)],1)],1),t("div",{staticClass:"reason-card-content"},[t("div",{staticClass:"bills-table"},[t("ds-table",{ref:"billsTableRef",attrs:{loading:e.loading,columns:e.columns,tableConfig:e.tableConfig,rowKey:e=>e._id,tableData:e.scrapTables},on:{handleSelectionChange:e.handleSelectionChange},scopedSlots:e._u([{key:"operation",fn:function({scope:s}){return[t("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(t){return e.editReason(s.row)}}},[e._v(e._s(e.$t("h.editBtn")))]),t("span",{staticClass:"line"}),t("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.deleteReason(s.row)}}},[e._v(e._s(e.$t("h.delBtn")))])]}}])})],1),t("div",{staticClass:"bills-pagination"},[t("ds-pagination",{attrs:{small:"",total:e.total,page:e.paginationForm.currentPage,limit:e.paginationForm.pageSize},on:{"update:page":function(t){return e.$set(e.paginationForm,"currentPage",t)},"update:limit":function(t){return e.$set(e.paginationForm,"pageSize",t)}}})],1)])]),t("new-bills-dialog",{staticClass:"new-bill-dialog",attrs:{title:e.$t("h.newBtn")+e.$t("h.scrapReason"),newBillsDialogVisible:e.reasonBillsDialogVisible},on:{"update:newBillsDialogVisible":function(t){e.reasonBillsDialogVisible=t},"update:new-bills-dialog-visible":function(t){e.reasonBillsDialogVisible=t},opened:e.reasonBillsDialogOpened,close:e.reasonBillsDialogClose,sbumitForm:e.sbumitReasonForm}},[t("template",{slot:"form"},[t("el-form",{ref:"reasonFormRef",attrs:{"label-width":"130px",model:e.reasonForm,rules:e.reasonFormRules}},[t("el-form-item",{attrs:{label:e.$t("h.scrapReason"),prop:"code","label-width":"120px"}},[t("el-input",{attrs:{placeholder:e.$t("h.tips3")+e.$t("h.scrapReason")},model:{value:e.reasonForm.scrapResult,callback:function(t){e.$set(e.reasonForm,"scrapResult",t)},expression:"reasonForm.scrapResult"}})],1)],1)],1)],2),t("ds-delete-detail",{attrs:{deleteDialogVisible:e.deleteDialogVisible,deleteColumns:e.deleteColumns,deleteErrorData:e.deleteErrorData},on:{"update:deleteDialogVisible":function(t){e.deleteDialogVisible=t},"update:delete-dialog-visible":function(t){e.deleteDialogVisible=t},closed:e.deleteDialogVisibleClosed}})],1)},a=[],l=(s(57658),s(98884)),n=s(42041),o=s(60983),r=s(93082),c=s(42228),d=s(19698),u=s(92003),h=s(89782),p=s(20629),g=s(83151),m=s(76080),f={components:{DsDeleteDetail:l.Z,NewBillsDialog:n.Z,DsTable:o.Z,DsPagination:r.Z,DsSearch:c.Z,DsQueryForm:d.Z,DsQueryFormLeftPanel:u.Z,DsQueryFormRightPanel:h.Z},data(){return{loading:!1,columns:g.F4,tableConfig:{selection:!0,reserveSelection:!0},total:0,paginationForm:{currentPage:1,pageSize:20},scrapReasonBills:[],selectScrapReasonBills:[],andLike:"",reasonBillsDialogVisible:!1,reasonLoading:{target:".new-bill-dialog",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"},reasonForm:{_id:"",scrapResult:""},reasonFormRules:{scrapResult:[{required:!0,message:this.$t("h.tips3")+this.$t("h.scrapReason"),trigger:"blur"}]},deleteDialogVisible:!1,deleteColumns:g.VU,deleteErrorData:[]}},computed:{...(0,p.rn)(["userInfo"]),scrapTables(){const e=this.andLike;return e?this.scrapReasonBills.filter((t=>Object.keys(t).some((s=>String(t[s]).indexOf(e)>-1)))):this.scrapReasonBills}},methods:{getScrapReasons(){this.loaidng=!1,(0,m.Ys)({func:"S0012",userId:this.userInfo._id,token:this.userInfo.token,requstData:{}}).then((({data:e})=>{if(this.loading=!1,0!=e.code)return this.$message.error(e.data);this.total=e.data.length,this.scrapReasonBills=e.data})).catch((()=>{this.loading=!1,this.$message.error(this.$t("h.tips18"))}))},handleSelectionChange(e){this.selectScrapReasonBills=e},editReason(e){this.reasonForm._id=e._id,this.reasonForm.scrapResult=e.scrapResult,this.reasonBillsDialogVisible=!0},deleteReason(e){this.$confirm(this.$t("h.tips158"),this.$t("h.title18"),{confirmButtonText:this.$t("h.confirmBtn"),cancelButtonText:this.$t("h.cancelBtn"),type:"warning"}).then((()=>{this.loading=!0,(0,m.SR)({func:"D0015",userId:this.userInfo._id,token:this.userInfo.token,requstData:{_id:e._id,permissonId:22}}).then((({data:e})=>{if(this.loading=!1,0!=e.code)return this.$message.error(e.data);this.getScrapReasons()})).catch((()=>{this.loading=!1,this.$message.error(this.$t("h.tips18"))}))})).catch((()=>{this.$message.info(this.$t("h.tips98"))}))},deleteReasons(){if(!this.selectScrapReasonBills.length)return this.$message.error(this.$t("h.tips159"));this.$confirm(this.$t("h.tips158"),this.$t("h.title18"),{confirmButtonText:this.$t("h.confirmBtn"),cancelButtonText:this.$t("h.cancelBtn"),type:"warning"}).then((()=>{this.loading=!0,this.deleteErrorData=[],this.multiDeleteReason(0)})).catch((()=>{this.$message.info(this.$t("h.tips98"))}))},multiDeleteReason(e){e>this.selectScrapReasonBills.length-1&&(this.paginationForm.currentPage=1,this.getScrapReasons(),this.$refs["billsTableRef"].$refs["dsTableRef"].clearSelection(),this.deleteErrorData.length?this.deleteDialogVisible=!0:this.$message.success(this.$t("h.tips160"))),(0,m.SR)().then((({data:t})=>{0!=t.code&&this.deleteErrorData.push({scrapResult:this.selectScrapReasonBills[e].scrapResult,reason:t.data}),this.multiDeleteReason(++e)})).catch((()=>{this.deleteErrorData.push({scrapResult:this.selectScrapReasonBills[e].scrapResult,reason:this.$t("h.tips18")}),this.multiDeleteReason(++e)}))},deleteDialogVisibleClosed(){this.deleteErrorData=[]},reasonBillsDialogOpened(){this.$refs.reasonFormRef.clearValidate()},reasonBillsDialogClose(){this.reasonForm._id="",this.reasonForm.scrapResult=""},sbumitReasonForm(){this.$refs.reasonFormRef.validate((e=>{if(!e)return!1;const t=this.$loading(this.reasonLoading);let s=""==this.reasonForm._id?20:21;(0,m.Vx)({func:"U0015",userId:this.userInfo._id,token:this.userInfo.token,requstData:{_id:this.reasonForm._id,scrapResult:this.reasonForm.scrapResult,permissonId:s}}).then((({data:e})=>{if(t.close(),0!=e.code)return this.$message.error(e.data);this.reasonBillsDialogVisible=!1,this.getScrapReasons(),this.$message.success(e.data)})).catch((()=>{t.close(),this.$message.error(this.$t("h.tips18"))}))}))}},created(){this.getScrapReasons()}},b=f,$=s(1001),D=(0,$.Z)(b,i,a,!1,null,"b8b1ca7e",null),v=D.exports}}]);