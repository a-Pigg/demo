"use strict";(self["webpackChunk_4010_assetweb"]=self["webpackChunk_4010_assetweb"]||[]).push([[6401],{25081:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"TemplateManagement"},[e("el-card",{staticClass:"template-card"},[e("div",{staticClass:"template-card-header",attrs:{slot:"header"},slot:"header"},[e("span",[t._v(t._s(t.$t("h.title200")))])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.templateLoading,expression:"templateLoading"}],staticClass:"template-card-content"},[e("el-row",[e("el-col",{attrs:{xs:24,sm:12,lg:8}},[e("div",{staticClass:"grid-content"},[e("div",{staticClass:"pedding-add-asset",on:{click:t.addInventoryTempalte}},[e("i",{staticClass:"el-icon-plus"})])])]),t._l(t.printTemplates,(function(a,s){return e("el-col",{key:a._id,attrs:{xs:24,sm:12,lg:8}},[e("div",{staticClass:"grid-content",on:{click:function(e){return t.checkInventoryTemplate(a._id)}}},[e("img",{staticClass:"template-img",attrs:{src:a.base}}),e("div",{staticClass:"mask-box"}),e("button",{directives:[{name:"show",rawName:"v-show",value:t.inventoryTemaplateId==a._id,expression:"inventoryTemaplateId == item._id"}],staticClass:"check-tempalate-btn"},[e("i",{staticClass:"el-icon-check"})]),e("button",{directives:[{name:"show",rawName:"v-show",value:a._id>7,expression:"item._id > 7"}],staticClass:"delete-template-btn",on:{click:function(e){return e.stopPropagation(),t.deleteInventoryTemplate(a._id)}}},[e("i",{staticClass:"el-icon-close"})]),e("button",{directives:[{name:"show",rawName:"v-show",value:a.edit,expression:"item.edit"}],staticClass:"edit-template-btn",on:{click:function(e){return e.stopPropagation(),t.editInventoryTemplate(s)}}},[e("i",{staticClass:"el-icon-edit"})])]),e("div",{staticClass:"title"},[e("span",[t._v(t._s(a.title))])])])}))],2)],1)]),e("draw-printed-pictures",{attrs:{customDialogVisible:t.customDialogVisible,step:t.step,tableData:t.templateItem,templateType:1,dataList:t.dataList},on:{"update:customDialogVisible":function(e){t.customDialogVisible=e},"update:custom-dialog-visible":function(e){t.customDialogVisible=e},"update:step":function(e){t.step=e},closed:t.customDialogVisibleClosed,refreshTags:t.getInventoryTemplates}})],1)},i=[],n=(a(57658),a(31235)),o=a(40926),l=a(92243),d=a(76080),m=a(20629),r={components:{DrawPrintedPictures:n.Z},computed:{...(0,m.rn)(["userInfo"])},data(){return{customDialogVisible:!1,step:!1,templateItem:{},templateLoading:!1,printTemplates:[],inventoryTemaplateId:null,inventoryTemplates:[],dataList:[{nameShow:this.$t("h.title166"),dbDataName:"code"},{nameShow:this.$t("h.formTips38"),dbDataName:"name"},{nameShow:this.$t("h.formTips63"),dbDataName:"barCode"},{nameShow:this.$t("h.formTips55"),dbDataName:"sorting"},{nameShow:this.$t("h.title198"),dbDataName:"logo"},{nameShow:this.$t("h.columns27"),dbDataName:"specification"},{nameShow:this.$t("h.columns28"),dbDataName:"measureUnit"},{nameShow:this.$t("h.columns70"),dbDataName:"price"},{nameShow:this.$t("h.columns57"),dbDataName:"lowerSize"},{nameShow:this.$t("h.columns58"),dbDataName:"upperSize"},{nameShow:this.$t("h.comment"),dbDataName:"remark"}]}},methods:{customDialogVisibleClosed(){this.templateItem={},this.step=!1},getInventoryTemplates(){this.templateLoading=!0,this.inventoryTemaplateId=window.localStorage.getItem("inventoryTemaplateId"),(0,d.Ys)({func:"S0019",userId:this.userInfo._id,token:this.userInfo.token,requstData:{type:1}}).then((async({data:t})=>{if(this.templateLoading=!1,0!=t.code)return this.$message.error(t.data);if(t.data&&t.data.length){this.inventoryTemplates=t.data,t.data.some((t=>t._id==this.inventoryTemaplateId))||(this.inventoryTemaplateId=t.data[0]._id,localStorage.setItem("inventoryTemaplateId",this.inventoryTemaplateId)),this.printTemplates=[];for(let e=0;e<t.data.length;e++)if(t.data[e].html){let a=document.createElement("div");a.style.position="fixed",a.style.top="-10000px",document.body.appendChild(a);let s=await(0,l.X)(t.data[e],a,void 0);document.body.removeChild(a),this.printTemplates.push({_id:t.data[e]._id,base:s,title:t.data[e].name,edit:!0})}else{let a=document.createElement("CANVAS"),s=await(0,o.h)(t.data[e],a,void 0,!1);s._id=t.data[e]._id,s.edit=t.data[e].false,this.printTemplates.push(s)}}})).catch((()=>{this.templateLoading=!1,this.$message.error(this.$t("h.tips18"))}))},addInventoryTempalte(){this.customDialogVisible=!0},checkInventoryTemplate(t){this.inventoryTemaplateId=t,window.localStorage.setItem("inventoryTemaplateId",t)},deleteInventoryTemplate(t){return t==this.inventoryTemaplateId?this.$notify.error({title:this.$t("h.title27"),message:this.$t("h.tips266")}):t<=7?this.$notify.error({title:this.$t("h.title27"),message:this.$t("h.drawLabelComponents77")}):void this.$confirm(this.$t("h.drawLabelComponents78"),this.$t("h.title18"),{confirmButtonText:this.$t("h.confirmBtn"),cancelButtonText:this.$t("h.cancelBtn"),type:"warning"}).then((()=>{this.templateLoading=!0,(0,d.SR)({func:"D0018",userId:this.userInfo._id,token:this.userInfo.token,requstData:{_id:t,permissonId:57,type:1}}).then((({data:t})=>{if(0!=t.code)return this.templateLoading=!1,this.$message.error(t.data);this.getInventoryTemplates(),this.$message.success(t.data)})).catch((()=>{this.templateLoading=!1,this.$message.error(this.$t("h.tips18"))}))})).catch((()=>{this.$message.info(this.$t("h.tips98"))}))},editInventoryTemplate(t){this.templateItem=this.inventoryTemplates[t],this.customDialogVisible=!0,this.step=!0}},created(){this.getInventoryTemplates()}},h=r,c=a(1001),p=(0,c.Z)(h,s,i,!1,null,"490e9269",null),u=p.exports}}]);